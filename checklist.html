<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½äº¤æ˜“å…¨æ–¹ä½æ•´åˆæ¸…å–®</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f3f4f6;
            scroll-behavior: smooth;
            /* Disable text selection */
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .checklist-item {
            transition: all 0.2s ease;
        }
        .checklist-item:hover {
            transform: translateX(4px);
        }
        /* Completed State */
        .checklist-item.completed {
            background-color: #f0fdf4; /* green-50 */
            border-left: 4px solid #22c55e; /* green-500 */
            opacity: 0.8;
        }
        .checklist-item.completed h3, 
        .checklist-item.completed p, 
        .checklist-item.completed li,
        .checklist-item.completed span {
            text-decoration: line-through;
            color: #9ca3af; /* gray-400 */
        }
        
        /* Arrow Rotation */
        .rotate-180 {
            transform: rotate(180deg);
        }

        /* Value Highlight Badge */
        .val-badge {
            background-color: #eff6ff;
            color: #1d4ed8;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-weight: bold;
            border: 1px solid #bfdbfe;
            display: inline-block;
        }
        .checklist-item.completed .val-badge {
            background-color: #f3f4f6;
            color: #9ca3af;
            border-color: #e5e7eb;
        }

        /* Category Header Badge */
        .cat-header {
            font-size: 0.85rem;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 6px;
            margin-top: 12px;
            letter-spacing: 0.05em;
        }
        /* Category Colors */
        .cat-basic { background-color: #e5e7eb; color: #374151; } /* Gray */
        .cat-dir { background-color: #e0e7ff; color: #4338ca; } /* Indigo */
        .cat-temp { background-color: #ffedd5; color: #c2410c; } /* Orange */
        .cat-cond { background-color: #d1fae5; color: #047857; } /* Emerald */
        .cat-stop { background-color: #fee2e2; color: #b91c1c; } /* Red */
        .cat-real { background-color: #f3e8ff; color: #7e22ce; } /* Purple */

        /* Sticky Header Glassmorphism */
        .sticky-header {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        /* Mode Switcher */
        .mode-btn {
            transition: all 0.3s ease;
        }
        .mode-btn.active {
            background-color: #ffffff;
            color: #2563eb;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Image Protection */
        .protected-image {
            user-select: none;
            -webkit-user-drag: none;
            pointer-events: none; /* Disables interaction */
        }
    </style>
</head>
<body class="pb-12" oncontextmenu="return false;" ondragstart="return false;" onselectstart="return false;">

    <!-- Sticky Progress Header -->
    <div class="sticky-header fixed top-0 left-0 right-0 z-50 px-4 py-3 border-b border-gray-800">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-lg font-bold text-white hidden sm:block">æ™ºèƒ½äº¤æ˜“æ¸…å–®ç³»çµ±</h1>
                <h1 class="text-lg font-bold text-white sm:hidden">æ™ºèƒ½äº¤æ˜“</h1>
                <p id="current-status-text" class="text-xs text-blue-400 mt-0.5 font-medium"></p>
            </div>
            <div class="flex items-center gap-2 sm:gap-3">
                <a href="index.html" class="hidden sm:inline-block text-xs bg-gray-800 text-gray-300 hover:bg-gray-700 px-3 py-1.5 rounded border border-gray-700 transition-colors">å›åˆ°é¦–é </a>
                <a href="https://lin.ee/n3bZgtk" target="_blank" class="hidden sm:inline-block text-xs bg-green-900 text-green-400 hover:bg-green-800 px-3 py-1.5 rounded border border-green-800 transition-colors">è¯ç¹«LINE</a>
                
                <!-- Mobile Icons for links -->
                <a href="index.html" class="sm:hidden text-gray-400 hover:text-white"><i class="fas fa-home"></i></a>
                <a href="https://lin.ee/n3bZgtk" target="_blank" class="sm:hidden text-green-400 hover:text-green-300"><i class="fab fa-line"></i></a>

                <div class="w-px h-6 bg-gray-600 mx-1"></div>

                <button id="btn-reset-all" class="text-xs bg-red-900 text-red-400 hover:bg-red-800 px-3 py-1.5 rounded border border-red-800 transition-colors">
                    é‡ç½®
                </button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container mx-auto px-4 pt-20 max-w-5xl">
        
        <!-- Welcome / Mode Switch Card -->
        <div class="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-xl shadow-lg p-6 mb-8 text-white relative overflow-hidden">
            <div class="absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-white opacity-10 rounded-full blur-xl"></div>
            
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                <div>
                    <h2 class="text-2xl font-bold mb-1">äº¤æ˜“ç­–ç•¥æ¸…å–®æª¢æŸ¥</h2>
                    <p class="text-blue-100 text-sm">è¨­å®šå‰è«‹å‹™å¿…é‡æ•´ç¶²é ï¼Œç¢ºä¿æ•¸æ“šæ›´æ–°ã€‚</p>
                </div>
                
                <!-- Mode Switcher -->
                <div class="bg-blue-800/50 p-1 rounded-lg flex text-sm">
                    <button onclick="switchMode('wed')" id="btn-mode-wed" class="mode-btn px-4 py-2 rounded-md text-blue-100 hover:text-white">
                        é€±ä¸‰çµç®—
                    </button>
                    <button onclick="switchMode('wedFri')" id="btn-mode-wedFri" class="mode-btn px-4 py-2 rounded-md text-blue-100 hover:text-white">
                        é€±ä¸‰/äº”çµç®—
                    </button>
                </div>
            </div>
        </div>

        <!-- Checklist Container -->
        <div id="checklist-container" class="space-y-6">
            <!-- Dynamic Content will be injected here by JS -->
        </div>

        <!-- Protected Image Section -->
        <div class="mt-8 mb-8 flex justify-center">
            <img src="0002.png" alt="Smart Trading Info" class="max-w-full h-auto rounded-lg shadow-sm protected-image" oncontextmenu="return false;" draggable="false">
        </div>

        <!-- Video Section -->
        <div id="video-section" class="mt-12 mb-12 bg-white rounded-xl shadow-md p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                æ•™å­¸å½±ç‰‡è³‡æº
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <a href="https://youtu.be/o5KV_8jDLw4" target="_blank" class="group block p-4 border rounded-lg hover:border-blue-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-blue-600">é¦–æ¬¡è¨­å®š</div>
                    <div class="text-xs text-gray-500 mt-1">é–‹å§‹äº¤æ˜“å‰çš„å¿…è¦æ­¥é©Ÿ</div>
                </a>
                <a href="https://youtu.be/aBhibtqOaGo" target="_blank" class="group block p-4 border rounded-lg hover:border-indigo-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-indigo-600">é€±ä¸‰å¤œï¼ˆç¬¬ä¸€å¤©ï¼‰</div>
                    <div class="text-xs text-gray-500 mt-1">å»ºç«‹æ¯é€±åˆå§‹éƒ¨ä½</div>
                </a>
                <a href="https://youtu.be/5fHULfAsRzc" target="_blank" class="group block p-4 border rounded-lg hover:border-purple-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-purple-600">é€±å››ï¼ˆç¬¬äºŒå¤©ï¼‰</div>
                    <div class="text-xs text-gray-500 mt-1">èª¿æ•´å€‰ä½</div>
                </a>
                <a href="https://youtu.be/MDZkuhcxXqc" target="_blank" class="group block p-4 border rounded-lg hover:border-pink-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-pink-600">é€±äº”ï¼ˆç¬¬ä¸‰å¤©ï¼‰</div>
                    <div class="text-xs text-gray-500 mt-1">é€±äº”æ“ä½œ</div>
                </a>
                <a href="https://youtu.be/KERu0ZofjOw" target="_blank" class="group block p-4 border rounded-lg hover:border-green-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-green-600">é€±ä¸€ï¼ˆç¬¬å››å¤©ï¼‰</div>
                    <div class="text-xs text-gray-500 mt-1">æ–°é€±èª¿æ•´</div>
                </a>
                <a href="https://youtu.be/ksXomVSZrv0" target="_blank" class="group block p-4 border rounded-lg hover:border-yellow-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-yellow-600">é€±äºŒï¼ˆç¬¬äº”å¤©ï¼‰</div>
                    <div class="text-xs text-gray-500 mt-1">æœ€å¾Œèª¿æ•´</div>
                </a>
                <a href="https://youtu.be/ZRsFse_Ldx8" target="_blank" class="group block p-4 border rounded-lg hover:border-red-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-red-600">çµç®—æ—¥æ“ä½œ</div>
                    <div class="text-xs text-gray-500 mt-1">å¹³å€‰èˆ‡é¢¨éšªæ§åˆ¶</div>
                </a>
                <a href="https://www.youtube.com/watch?v=7wLiCX8N4OA" target="_blank" class="group block p-4 border rounded-lg hover:border-gray-400 hover:shadow-md transition">
                    <div class="font-bold text-gray-800 group-hover:text-gray-600">é€±ä¸‰/äº”çµç®—ç¤ºç¯„</div>
                    <div class="text-xs text-gray-500 mt-1">å…­æ—¥ç©ºæ‰‹çš„ç´°ç¯€èˆ‡æ³¨æ„äº‹é …</div>
                </a>
            </div>
        </div>

        <div class="text-center text-gray-400 text-xs mb-8">
            Smart Trading System Checklist v3.6
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- Data Definitions ---

        // Helper to get class by category name
        function getCatClass(cat) {
            switch(cat) {
                case 'åŸºæœ¬è¨­å®š': return 'cat-basic';
                case 'æ–¹å‘åˆ¤æ–·': return 'cat-dir';
                case 'å¤šç©ºæº«åº¦èª¿æ•´': return 'cat-temp';
                case 'äº¤æ˜“æ¢ä»¶': return 'cat-cond';
                case 'åœæåœåˆ©': return 'cat-stop';
                case 'å³æ™‚ç¸½é»ç®¡æ§': return 'cat-real';
                case 'è‹¥è™§æ2%ä»¥ä¸Š': return 'cat-stop'; 
                default: return 'cat-basic';
            }
        }

        // Mode 1: Wednesday Settlement (Updated Structure)
        const dataWed = [
            {
                id: 'w-day-0',
                title: 'é¦–æ¬¡è¨­å®šï¼ˆé–‹å§‹äº¤æ˜“ï¼‰',
                color: 'blue',
                description: 'çµç®—è‡ªå‹•æ›å¥‘ç´„ï¼šå›ºå®šè¿‘å‘¨ä¸‰',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'çµç®—è‡ªå‹•æ›å¥‘ç´„ï¼Œé¸ <span class="val-badge">å›ºå®šè¿‘å‘¨ä¸‰</span>' },
                    { text: 'åœ¨ã€ŒæŠ•å…¥è³‡é‡‘æœ¬é‡‘ã€è¼¸å…¥æ‚¨çš„è³‡é‡‘é‡‘é¡ï¼ˆä¾‹å¦‚ï¼š<span class="val-badge">400000</span>ï¼‰' },
                    { text: 'é‡è¦ï¼šåœ¨ã€Œä¿ç•™å¯ç”¨é¤˜é¡ã€è¼¸å…¥ <span class="val-badge">1000%</span>ï¼Œç¢ºä¿ç¨‹å¼ä¸æœƒæ„å¤–ä¸‹å–®', important: true },
                    { text: 'æ¯”ç…§ç¤ºç¯„40è¬çš„è¨­å®šï¼Œè¼¸å…¥æ‰€æœ‰æ¬„ä½çš„æ•¸å€¼èˆ‡é¸é …èˆ‡å‹¾é¸' },
                    { text: 'ç¢ºèªå…¨éƒ¨å®Œæˆå¾Œï¼Œå·¦ä¸Šè§’æŒ‰ã€Œé–‹å§‹äº¤æ˜“ã€', important: true }
                ]
            },
            {
                id: 'w-day-1',
                title: 'é€±ä¸‰å¤œï¼ˆç¬¬ä¸€å¤©ï¼‰',
                color: 'indigo',
                description: 'å»ºç«‹éƒ¨ä½',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ã€æŠ•å…¥è³‡é‡‘æˆæœ¬ã€‘å¯æ›´æ–°ç‚ºç›®å‰åº«å­˜æ²’æœ‰éƒ¨ä½çš„ã€æ¬Šç›Šç¸½å€¼ã€‘' },
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: 'ä¾ç…§æ™ºèƒ½å ±åƒ¹è¶¨å‹¢åˆ¤æ–·ï¼šåˆè¨ˆæ–¹å‘/å¤šç©ºæº«åº¦ ï¼› æˆ–è‡ªæ€§åˆ¤æ–·:é€†å‹¢å¤šç©ºæº«åº¦/æœŸè²¨åƒ¹æ ¼' },
                    { text: 'ç¢ºèªæ–¹å‘åˆ¤æ–· ï¼ˆå¯åŒæ­¥ç¤ºç¯„ï¼‰è¨­å®šç¬¦åˆç•¶å‰å¸‚å ´è¶¨å‹¢' },
                    { isHeader: true, text: 'å¤šç©ºæº«åº¦èª¿æ•´' },
                    { text: '<strong>å–æ¶ˆæ‰“å‹¾</strong>' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢æ™ºèƒ½å ±åƒ¹ 100åƒ¹å·®æ¥è¿‘ <span class="val-badge">8~11</span> çš„æˆäº¤åƒ¹ä¸¦è¼¸å…¥è¨­å®š' },
                    { text: 'è¤‡å¼å–® BP åƒ¹å¤– <span class="val-badge">100</span> é»' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'å°‡ä¿ç•™å¯ç”¨é¤˜é¡æ”¹ç‚º <span class="val-badge">85~90%</span> (åªä½¿ç”¨15~10%è³‡é‡‘)' }
                ]
            },
            {
                id: 'w-day-2',
                title: 'é€±å››ï¼ˆç¬¬äºŒå¤©ï¼‰',
                color: 'purple',
                description: 'èª¿æ•´å€‰ä½',
                items: [
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: 'ç¢ºèªè¨­å®šç¬¦åˆç•¶å‰å¸‚å ´è¶¨å‹¢' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢ 100åƒ¹å·® <span class="val-badge">8~11</span> çš„æˆäº¤åƒ¹ä¸¦è¼¸å…¥è¨­å®š' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡èª¿æ•´ç‚º <span class="val-badge">60~70%</span>' }
                ]
            },
            {
                id: 'w-day-3',
                title: 'é€±äº”ï¼ˆç¬¬ä¸‰å¤©ï¼‰',
                color: 'pink',
                description: 'é€±äº”æ“ä½œ',
                items: [
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: 'ç¢ºèªè¨­å®šç¬¦åˆå¸‚å ´' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢ 100åƒ¹å·® <span class="val-badge">8~11</span> çš„æˆäº¤åƒ¹ä¸¦è¼¸å…¥è¨­å®š' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡èª¿æ•´ç‚º <span class="val-badge">50~45%</span>' },
                    { text: 'è³‡é‡‘ä½ˆå±€å®Œå¾Œï¼š1.å–æ¶ˆæ–¹å‘åˆ¤æ–· 2.é–‹å•Ÿå¤šç©ºæº«åº¦èª¿æ•´ 3.ä¿ç•™å¯ç”¨é¤˜é¡é™ä½1~20%' }
                ]
            },
            {
                id: 'w-day-4',
                title: 'é€±ä¸€ï¼ˆç¬¬å››å¤©ï¼‰',
                color: 'green',
                description: 'æ–°é€±èª¿æ•´',
                items: [
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: '<strong>å…¨éƒ¨å–æ¶ˆæ‰“å‹¾</strong> (æ¸›å°‘å»ºå€‰)' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢ 100åƒ¹å·®æ¥è¿‘ <span class="val-badge">8~9</span> (è‹¥è™§ææ‰¾æ¥è¿‘14) çš„æˆäº¤åƒ¹ä¸¦è¨­å®š' },
                    { isHeader: true, text: 'å¤šç©ºæº«åº¦èª¿æ•´' },
                    { text: '<strong>æ‰“å‹¾å•Ÿç”¨</strong>' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡èª¿æ•´ç‚º <span class="val-badge">1%~20%</span>' },
                    { isHeader: true, text: 'åœæåœåˆ©' },
                    { text: 'é–‹å•Ÿä¿åˆ©é™éƒ¨ä½1èˆ‡2' },
                    { text: 'è‹¥æç›Šä¸ä½³ï¼ˆ-2%ï¼‰ï¼Œå•Ÿç”¨åœåˆ©åŠŸèƒ½ (é‡‹æ”¾è³‡é‡‘)' }
                ]
            },
            {
                id: 'w-day-5',
                title: 'é€±äºŒï¼ˆç¬¬äº”å¤©ï¼‰',
                color: 'yellow',
                description: 'æœ€å¾Œèª¿æ•´',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™é¤˜é¡èª¿ç‚º <span class="val-badge">1%</span>' },
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: '<strong>å…¨éƒ¨å–æ¶ˆæ‰“å‹¾</strong>' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢ 100åƒ¹å·® <span class="val-badge">8</span> (è‹¥è™§ææ‰¾æ¥è¿‘14) çš„æˆäº¤åƒ¹' },
                    { text: 'è¤‡å¼å–® B åƒ¹å¤–ï¼Œæ”¹ <span class="val-badge">50</span> é»' },
                    { isHeader: true, text: 'åœæåœåˆ©' },
                    { text: 'è‹¥æç›Šä¸ä½³(-2%)ï¼Œé–‹å•Ÿåœæåœåˆ©' }
                ]
            },
            {
                id: 'w-day-6',
                title: 'é€±ä¸‰ï¼ˆçµç®—æ—¥ï¼‰',
                color: 'red',
                description: 'çµç®—æ—¥',
                items: [
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: '<strong>å…¨éƒ¨å–æ¶ˆæ‰“å‹¾</strong>' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šå›ºå®šè¨­å®šç‚º <span class="val-badge">40</span> (20~44çš†å¯)' },
                    { isHeader: true, text: 'å³æ™‚ç¸½é»ç®¡æ§' },
                    { text: 'å•Ÿç”¨ã€Œæ—¥ç›¤å®šæ™‚å¹³å€‰ã€ï¼Œæ™‚é–“ <span class="val-badge">12:45</span>' },
                    { text: 'å¹³å€‰ç¸½é»è¨­å®šï¼šæŒå€‰æ•¸é‡(SC+SP) x 0.5~1å€' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: '<strong>âš ï¸ çµç®—å¾Œæé†’ï¼š</strong>ä¸‹åˆ2é»å¾Œç¢ºèªå¯ç”¨ä¿ç•™é¤˜é¡æ˜¯å¦æ˜¯ <span class="val-badge">1000%</span> (ç¨‹å¼æœƒè‡ªå‹•è¨­å®š1000%)', important: true }
                ]
            },
            {
                id: 'w-day-emergency',
                title: 'ç·Šæ€¥èª¿æ•´ï¼ˆè‹¥è™§æ2%ä»¥ä¸Šï¼‰',
                color: 'darkRed', // Changed to darkRed
                description: 'åƒ…åœ¨æç›Šä¸ä½³æ™‚åŸ·è¡Œæ­¤å€å¡Šè¨­å®š',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡è¨­å®šç‚º <span class="val-badge">2%</span> (ç›®çš„æ˜¯å»ºç«‹æ›´å¤šéƒ¨ä½ä¾†è£œæ•‘è™§æ)' },
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: 'å‹¾é¸å¤šç©ºæº«åº¦' },
                    { isHeader: true, text: 'å¤šç©ºæº«åº¦èª¿æ•´' },
                    { text: 'å‹¾é¸å•Ÿç”¨' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢100åƒ¹å·® <span class="val-badge">14</span> çš„æˆäº¤åƒ¹' },
                    { text: 'ï¼ˆçµç®—æ—¥ç›´æ¥å›ºå®šè¨­å®šç‚º <span class="val-badge">30ï½20</span>ï¼‰' },
                    { isHeader: true, text: 'åœæåœåˆ©' },
                    { text: 'å‹¾é¸åœåˆ©(è³‡é‡‘æ»¾å‹•å†å¸ƒå±€),æ˜¯å¦å‹¾é¸åœæéœ€è‡ªè¡Œæ±ºå®š' },
                    { text: 'å‹¾é¸ ä¿åˆ©é™éƒ¨ä½1 è¨­å®š  ç²åˆ© % >=  <span class="val-badge">0%</span>, <span class="val-badge">15</span>é»ä»¥ä¸‹ä¸å¹³å€‰' }
                ]
            }
        ];

        // Mode 2: Wed/Fri Settlement (Aggregated Strategy)
        const dataWedFri = [
            {
                id: 'wf-setup',
                title: 'é¦–æ¬¡è¨­å®šï¼ˆé–‹å§‹äº¤æ˜“ï¼‰',
                color: 'blue',
                description: 'é©ç”¨æ–¼é€±ä¸‰èˆ‡é€±äº”é›™çµç®—ç­–ç•¥',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'çµç®—è‡ªå‹•æ›å¥‘ç´„ï¼Œé¸ <span class="val-badge">æœ¬é€±ä¸‰<=>æœ¬é€±äº”</span>' },
                    { text: 'åœ¨ã€ŒæŠ•å…¥è³‡é‡‘æœ¬é‡‘ã€è¼¸å…¥æ‚¨çš„è³‡é‡‘é‡‘é¡ï¼ˆä¾‹å¦‚ï¼š<span class="val-badge">400000</span>ï¼‰' },
                    { text: 'é‡è¦ï¼šåœ¨ã€Œä¿ç•™å¯ç”¨é¤˜é¡ã€è¼¸å…¥ <span class="val-badge">1000%</span>ï¼Œç¢ºä¿ç¨‹å¼ä¸æœƒæ„å¤–ä¸‹å–®', important: true },
                    { text: 'æ¯”ç…§ç¤ºç¯„40è¬çš„è¨­å®šï¼Œè¼¸å…¥æ‰€æœ‰æ¬„ä½çš„æ•¸å€¼èˆ‡é¸é …èˆ‡å‹¾é¸' },
                    { text: 'ç¢ºèªå…¨éƒ¨å®Œæˆå¾Œï¼Œå·¦ä¸Šè§’æŒ‰ã€Œé–‹å§‹äº¤æ˜“ã€', important: true }
                ]
            },
            {
                id: 'wf-day-1',
                title: 'ğŸ“… é€±ä¸€æ—¥æˆ–é€±ä¸‰å¤œï¼ˆç¬¬ä¸€å¤©ï¼‰',
                color: 'indigo',
                description: 'å»ºç«‹éƒ¨ä½',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ã€æŠ•å…¥è³‡é‡‘æˆæœ¬ã€‘å¯æ›´æ–°ç‚ºæ¬Šç›Šç¸½å€¼' },
                    { isHeader: true, text: 'å³æ™‚ç¸½é»ç®¡æ§' },
                    { text: 'è¨­å®šï¼šä½¿ç”¨å°å·¥å…·ï¼Œ100åƒ¹å·®æ”¹ç‚º <span class="val-badge">8</span>' },
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: 'è¨­å®šï¼šå‹¾é¸å•Ÿç”¨ã€Œåˆè¨ˆæ–¹å‘/å¤šç©ºæº«åº¦ã€' },
                    { isHeader: true, text: 'å¤šç©ºæº«åº¦èª¿æ•´' },
                    { text: 'è¨­å®šï¼š<strong>å–æ¶ˆæ‰“å‹¾</strong>' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹è¨­å®šï¼šå°‹æ‰¾ 100åƒ¹å·®æ¥è¿‘ <span class="val-badge">8~9</span> çš„æˆäº¤åƒ¹' },
                    { text: 'è¤‡å¼å–® BP åƒ¹å¤– <span class="val-badge">100</span> é»' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡æ”¹ç‚º <span class="val-badge">75~65%</span> (åªä½¿ç”¨25~35%è³‡é‡‘)' }
                ]
            },
            {
                id: 'wf-day-2',
                title: 'ğŸ“… é€±äºŒæˆ–é€±å››ï¼ˆç¬¬äºŒå¤©ï¼‰',
                color: 'purple',
                description: 'èª¿æ•´èˆ‡åŠ ç¢¼',
                items: [
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: '<strong>æ‰“å‹¾å•Ÿç”¨</strong>ï¼Œç¬¦åˆæ™ºèƒ½å ±åƒ¹è¶¨å‹¢ã€‚(å¤œç›¤å–æ¶ˆæ–¹å‘åˆ¤æ–·!)' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹è¨­å®šï¼š(æ—¥/å¤œç›¤æœ€å°‘2æ¬¡) å°‹æ‰¾ 100åƒ¹å·®æ¥è¿‘ <span class="val-badge">8</span> (è™§ææ”¹14)' },
                    { text: 'æ—¥ç›¤è¤‡å¼å–®BP/BCåƒ¹å¤– <span class="val-badge">100</span> é»ï¼Œå¤œç›¤22é»å¾Œæ”¹ <span class="val-badge">50</span> é»' },
                    { isHeader: true, text: 'å¤šç©ºæº«åº¦èª¿æ•´' },
                    { text: '<strong>å¤œç›¤æ‰“å‹¾å•Ÿç”¨</strong>' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡ æ—¥ç›¤ <span class="val-badge">50%</span> / å¤œç›¤ <span class="val-badge">2%</span>' },
                    { isHeader: true, text: 'åœæåœåˆ©' },
                    { text: 'è‹¥æç›Šä¸ä½³(-2%)ï¼šå•Ÿç”¨åœæåœåˆ©ï¼Œä¿ç•™é¤˜é¡èª¿ç‚º <span class="val-badge">2%</span>' }
                ]
            },
            {
                id: 'wf-day-3',
                title: 'ğŸ“… é€±ä¸‰æˆ–é€±äº”ï¼ˆçµç®—æ—¥ï¼‰',
                color: 'red',
                description: 'çµç®—æ—¥æ“ä½œ',
                items: [
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: '<strong>å…¨éƒ¨å–æ¶ˆæ‰“å‹¾</strong>' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šå›ºå®šè¨­å®šç‚º <span class="val-badge">40</span> (20~44çš†å¯)' },
                    { isHeader: true, text: 'å³æ™‚ç¸½é»ç®¡æ§' },
                    { text: 'å•Ÿç”¨ã€Œæ—¥ç›¤å®šæ™‚å¹³å€‰ã€ï¼Œæ™‚é–“ <span class="val-badge">12:45</span>' },
                    { text: 'å¹³å€‰ç¸½é»è¨­å®šï¼šæŒå€‰æ•¸é‡(SC+SP) x 0.5~1å€' },
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: '<strong>âš ï¸ çµç®—å¾Œæé†’ï¼š</strong>ä¸‹åˆ2é»å¾Œç¢ºèªå¯ç”¨ä¿ç•™é¤˜é¡æ˜¯å¦æ˜¯ <span class="val-badge">1000%</span> (ç¨‹å¼æœƒè‡ªå‹•è¨­å®š1000%)', important: true }
                ]
            },
            {
                id: 'wf-day-emergency',
                title: 'ç·Šæ€¥èª¿æ•´ï¼ˆè‹¥è™§æ2%ä»¥ä¸Šï¼‰',
                color: 'darkRed', // Changed to darkRed
                description: 'åƒ…åœ¨æç›Šä¸ä½³æ™‚åŸ·è¡Œæ­¤å€å¡Šè¨­å®š',
                items: [
                    { isHeader: true, text: 'åŸºæœ¬è¨­å®š' },
                    { text: 'ä¿ç•™å¯ç”¨é¤˜é¡è¨­å®šç‚º <span class="val-badge">2%</span> (ç›®çš„æ˜¯å»ºç«‹æ›´å¤šéƒ¨ä½ä¾†è£œæ•‘è™§æ)' },
                    { isHeader: true, text: 'æ–¹å‘åˆ¤æ–·' },
                    { text: 'å‹¾é¸å¤šç©ºæº«åº¦' },
                    { isHeader: true, text: 'å¤šç©ºæº«åº¦èª¿æ•´' },
                    { text: 'å‹¾é¸å•Ÿç”¨' },
                    { isHeader: true, text: 'äº¤æ˜“æ¢ä»¶' },
                    { text: 'å‹•æ…‹Sellåƒ¹ï¼šæŸ¥è©¢100åƒ¹å·® <span class="val-badge">14</span> çš„æˆäº¤åƒ¹' },
                    { text: 'ï¼ˆçµç®—æ—¥ç›´æ¥å›ºå®šè¨­å®šç‚º <span class="val-badge">30ï½20</span>ï¼‰' },
                    { isHeader: true, text: 'åœæåœåˆ©' },
                    { text: 'å‹¾é¸åœåˆ©(è³‡é‡‘æ»¾å‹•å†å¸ƒå±€),æ˜¯å¦å‹¾é¸åœæéœ€è‡ªè¡Œæ±ºå®š' },
                    { text: 'å‹¾é¸ ä¿åˆ©é™éƒ¨ä½1 è¨­å®š  ç²åˆ© % >=  <span class="val-badge">0%</span>, <span class="val-badge">15</span>é»ä»¥ä¸‹ä¸å¹³å€‰' }
                ]
            }
        ];

        // --- App Logic ---

        let currentMode = 'wed'; // 'wed' or 'wedFri'
        let checklistData = dataWed; // Default

        // Color Mapping for Tailwind classes
        const colorClasses = {
            blue: { header: 'from-blue-600 to-blue-500', icon: 'text-blue-600' },
            indigo: { header: 'from-indigo-600 to-indigo-500', icon: 'text-indigo-600' },
            purple: { header: 'from-purple-600 to-purple-500', icon: 'text-purple-600' },
            pink: { header: 'from-pink-600 to-pink-500', icon: 'text-pink-600' },
            green: { header: 'from-green-600 to-green-500', icon: 'text-green-600' },
            yellow: { header: 'from-yellow-500 to-yellow-400', icon: 'text-yellow-600' },
            red: { header: 'from-red-600 to-red-500', icon: 'text-red-600' },
            darkRed: { header: 'from-red-900 to-red-800', icon: 'text-red-900' },
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved mode or default to 'wed'
            const savedMode = localStorage.getItem('smart-trading-mode');
            if (savedMode) {
                switchMode(savedMode);
            } else {
                switchMode('wed'); // This ensures the 'wed' button gets the .active class on first load
            }
        });

        function switchMode(mode) {
            currentMode = mode;
            localStorage.setItem('smart-trading-mode', mode);

            // Update UI Buttons
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-mode-${mode}`).classList.add('active');

            // Switch Data
            checklistData = (mode === 'wed') ? dataWed : dataWedFri;

            // Re-render
            renderChecklists();
            loadProgress();
            
            // Auto expand today
            autoExpandToday();
        }

        // Logic to auto-expand today's card
        function autoExpandToday() {
            const now = new Date();
            const day = now.getDay(); // 0-6 Sun-Sat
            const hour = now.getHours();

            // Night session definition: 14:00 to 05:00 (next day)
            // Adjust day for hours 00:00 - 05:00 to belong to previous "trading day"
            let tradingDay = day;
            let isNight = false;

            if (hour < 5) {
                tradingDay = (day + 6) % 7; // Previous day
                isNight = true; // Late night part of night session
            } else if (hour >= 14) {
                isNight = true;
            }

            let targetId = null;
            let statusText = `ä»Šå¤©æ˜¯: é€±${['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][day]} ${hour}é» (${isNight ? 'å¤œç›¤' : 'æ—¥ç›¤'})`;

            if (currentMode === 'wed') {
                // Mode 1: Wed Settlement
                if (tradingDay === 3) { // Wed
                    targetId = isNight ? 'w-day-1' : 'w-day-6';
                } else if (tradingDay === 4) { // Thu
                    targetId = 'w-day-2';
                } else if (tradingDay === 5) { // Fri
                    targetId = 'w-day-3';
                } else if (tradingDay === 1) { // Mon
                    targetId = 'w-day-4';
                } else if (tradingDay === 2) { // Tue
                    targetId = 'w-day-5';
                }
            } else {
                // Mode 2: Wed/Fri Settlement
                if (tradingDay === 1) { // Mon
                    targetId = 'wf-day-1';
                } else if (tradingDay === 2) { // Tue
                    targetId = 'wf-day-2';
                } else if (tradingDay === 3) { // Wed
                    targetId = isNight ? 'wf-day-1' : 'wf-day-3';
                } else if (tradingDay === 4) { // Thu
                    targetId = 'wf-day-2';
                } else if (tradingDay === 5) { // Fri
                    targetId = isNight ? null : 'wf-day-3'; // Fri Night is rest
                }
            }
            
            // Update Status Text
            const statusEl = document.getElementById('current-status-text');
            if(statusEl) statusEl.innerText = statusText;

            // Expand target
            if (targetId) {
                const content = document.getElementById(`content-${targetId}`);
                const arrow = document.getElementById(`arrow-${targetId}`);
                if (content && arrow) {
                    content.classList.remove('hidden');
                    arrow.classList.add('rotate-180');
                    // Scroll to view
                    setTimeout(() => {
                        const card = document.getElementById(`card-${targetId}`);
                        if(card) card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 200);
                }
            }
        }

        // Render Functions
        function renderChecklists() {
            const container = document.getElementById('checklist-container');
            container.innerHTML = '';

            checklistData.forEach(day => {
                const styles = colorClasses[day.color];
                
                const dayCard = document.createElement('div');
                dayCard.className = 'bg-white rounded-xl shadow-md overflow-hidden transition hover:shadow-lg';
                dayCard.id = `card-${day.id}`;

                // Header
                const header = document.createElement('div');
                header.className = `bg-gradient-to-r ${styles.header} p-4 cursor-pointer flex justify-between items-center text-white`;
                header.onclick = () => toggleCard(day.id);
                
                // Calculate countable items (exclude headers)
                const countableItems = day.items.filter(i => !i.isHeader).length;

                header.innerHTML = `
                    <div>
                        <h2 class="text-lg font-bold flex items-center gap-2">
                            ${day.title}
                        </h2>
                        <p class="text-xs opacity-90 font-light mt-1">${day.description}</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <span id="count-${day.id}" class="bg-white/20 px-2 py-1 rounded text-xs font-mono">0/${countableItems}</span>
                        <button onclick="event.stopPropagation(); resetDay('${day.id}')" title="é‡ç½®é€™ä¸€å¤©" class="p-1 hover:bg-white/20 rounded-full transition">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                        </button>
                        <svg id="arrow-${day.id}" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>
                `;

                // Content
                const content = document.createElement('div');
                content.id = `content-${day.id}`;
                content.className = 'hidden bg-gray-50'; // Default hidden

                const list = document.createElement('div');
                list.className = 'p-4 space-y-3';

                day.items.forEach((item, index) => {
                    const itemId = `${day.id}-item-${index}`;
                    
                    if (item.isHeader) {
                        const headerDiv = document.createElement('div');
                        const catClass = getCatClass(item.text);
                        headerDiv.className = `cat-header ${catClass}`;
                        headerDiv.innerText = item.text;
                        list.appendChild(headerDiv);
                    } else {
                        const div = document.createElement('div');
                        div.className = 'checklist-item bg-white p-3 rounded-lg border border-gray-200 shadow-sm flex items-start cursor-pointer select-none';
                        if (item.important) div.classList.add('border-l-4', 'border-l-red-400'); // Warning visual

                        div.onclick = (e) => {
                            // Prevent triggering if clicking a link inside text
                            if (e.target.tagName === 'A') return;
                            toggleItem(itemId, div);
                        };

                        div.innerHTML = `
                            <div class="flex-shrink-0 mt-1">
                                <input type="checkbox" id="${itemId}" class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none">
                            </div>
                            <div class="ml-3 text-gray-700 text-sm leading-relaxed ${item.important ? 'font-medium text-red-700' : ''}">
                                ${item.text}
                            </div>
                        `;
                        list.appendChild(div);
                    }
                });

                content.appendChild(list);
                dayCard.appendChild(header);
                dayCard.appendChild(content);
                container.appendChild(dayCard);
            });
        }

        // Logic Functions
        function toggleCard(dayId) {
            const content = document.getElementById(`content-${dayId}`);
            const arrow = document.getElementById(`arrow-${dayId}`);
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                arrow.classList.add('rotate-180');
            } else {
                content.classList.add('hidden');
                arrow.classList.remove('rotate-180');
            }
        }

        function toggleItem(itemId, itemDiv) {
            const checkbox = document.getElementById(itemId);
            const isChecking = !checkbox.checked;
            
            checkbox.checked = isChecking;
            
            if (isChecking) {
                itemDiv.classList.add('completed');
            } else {
                itemDiv.classList.remove('completed');
            }

            saveProgress();
            updateGlobalProgress();
        }

        function updateGlobalProgress() {
            let totalItems = 0;
            let checkedItems = 0;

            checklistData.forEach(day => {
                const dayChecked = document.querySelectorAll(`#content-${day.id} input:checked`).length;
                const countableItems = day.items.filter(i => !i.isHeader).length;
                
                // Update Individual Card Counter
                const counter = document.getElementById(`count-${day.id}`);
                if(counter) counter.innerText = `${dayChecked}/${countableItems}`;

                totalItems += countableItems;
                checkedItems += dayChecked;
            });
        }

        // Modified save/load to use unique keys for different modes
        function saveProgress() {
            const savedData = {};
            checklistData.forEach(day => {
                day.items.forEach((item, index) => {
                    if (item.isHeader) return;
                    const itemId = `${day.id}-item-${index}`;
                    const checkbox = document.getElementById(itemId);
                    if (checkbox && checkbox.checked) {
                        savedData[itemId] = true;
                    }
                });
            });
            // Use currentMode in the key
            localStorage.setItem(`smart-trading-progress-${currentMode}`, JSON.stringify(savedData));
        }

        function loadProgress() {
            // Load based on currentMode
            const saved = localStorage.getItem(`smart-trading-progress-${currentMode}`);
            if (saved) {
                const savedData = JSON.parse(saved);
                for (const itemId in savedData) {
                    const checkbox = document.getElementById(itemId);
                    if (checkbox) {
                        checkbox.checked = true;
                        checkbox.closest('.checklist-item').classList.add('completed');
                    }
                }
            }
        }

        function resetDay(dayId) {
            if (!confirm('ç¢ºå®šè¦æ¸…ç©ºé€™ä¸€å¤©çš„å‹¾é¸å—ï¼Ÿ')) return;
            
            const inputs = document.querySelectorAll(`#content-${dayId} input`);
            inputs.forEach(input => {
                input.checked = false;
                input.closest('.checklist-item').classList.remove('completed');
            });
            
            saveProgress();
            updateGlobalProgress();
        }

        document.getElementById('btn-reset-all').onclick = () => {
            if (!confirm('ç¢ºå®šè¦å…¨éƒ¨é‡ç½®ç›®å‰æ¨¡å¼å—ï¼Ÿ')) return;
            // Clear only current mode data
            localStorage.removeItem(`smart-trading-progress-${currentMode}`);
            
            document.querySelectorAll('input[type="checkbox"]').forEach(input => {
                input.checked = false;
                input.closest('.checklist-item').classList.remove('completed');
            });
            
            updateGlobalProgress();
            // Close all cards
            checklistData.forEach(day => {
                const content = document.getElementById(`content-${day.id}`);
                const arrow = document.getElementById(`arrow-${day.id}`);
                if(content) content.classList.add('hidden');
                if(arrow) arrow.classList.remove('rotate-180');
            });
        };
    </script>
</body>
</html>


