<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>價格趨勢分析工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f4f8;
        }
        .input-field {
            @apply px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500;
            width: 50%;
            text-align: center;
        }
        .card {
            @apply bg-white rounded-xl shadow-md p-6 transition-all duration-300;
        }
        .card:hover {
            @apply shadow-lg;
        }
        .analysis-item {
            @apply flex justify-between items-center py-2 border-b border-gray-100;
        }
        .analysis-value {
            @apply font-semibold;
        }
        .positive {
            @apply text-green-600;
        }
        .negative {
            @apply text-red-600;
        }
        .neutral {
            @apply text-gray-600;
        }
        .price-bar {
            @apply h-10 rounded-md flex items-center justify-between px-4 text-sm font-medium my-1.5;
            transition: all 0.3s ease;
        }
        .price-name {
            @apply font-medium;
        }
        .price-value {
            @apply font-bold;
        }
        .current-price {
            @apply bg-blue-600;
        }
        .code-star {
            position: fixed;
            bottom: 10px;
            left: 10px;
            opacity: 0.1;
            font-size: 24px;
            cursor: pointer;
            z-index: 1000;
            color: #333;
            transition: opacity 0.3s;
        }
        .code-star:hover {
            opacity: 0.5;
        }
        .code-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 2000;
            overflow: auto;
        }
        .code-content {
            background-color: #f8f8f8;
            margin: 5% auto;
            padding: 20px;
            width: 90%;
            max-width: 1200px;
            border-radius: 8px;
            max-height: 80vh;
            overflow: auto;
        }
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .code-close {
            font-size: 24px;
            cursor: pointer;
        }
        .code-area {
            background-color: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
        }
        .input-container {
            @apply flex items-center justify-between;
        }
        .input-label {
            @apply block text-xs text-gray-600 mb-0;
            width: 45%;
        }
        .update-btn-container {
            @apply flex justify-center;
        }
        /* Ensure number inputs are centered in all browsers */
        input[type="number"] {
            text-align: center !important;
            -moz-appearance: textfield;
        }
        /* Remove spinner buttons for Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        /* Make text on blue backgrounds white */
        .bg-blue-600 .price-name,
        .bg-blue-600 .price-value {
            color: white;
        }
        .qr-container {
            @apply flex justify-center mt-4;
        }
        .qr-card {
            @apply bg-white rounded-xl shadow-md p-4 transition-all duration-300 flex flex-col items-center;
            max-width: 180px;
        }
        .qr-card:hover {
            @apply shadow-lg;
        }
        .qr-image {
            @apply rounded-lg;
            max-width: 150px;
            transition: transform 0.3s ease;
        }
        .qr-image:hover {
            transform: scale(1.05);
        }
        .qr-text {
            @apply text-sm text-gray-600 mt-2 text-center;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.relative{position:relative}.col-span-1{grid-column:span 1 / span 1}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mr-1{margin-right:0.25rem}.flex{display:flex}.grid{display:grid}.h-4{height:1rem}.min-h-screen{min-height:100vh}.w-1\/2{width:50%}.w-4{width:1rem}.max-w-6xl{max-width:72rem}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-rows-2{grid-template-rows:repeat(2, minmax(0, 1fr))}.items-center{align-items:center}.justify-center{justify-content:center}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-6{gap:1.5rem}.gap-4{gap:1rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-green-300{--tw-bg-opacity:1;background-color:rgb(134 239 172 / var(--tw-bg-opacity, 1))}.bg-red-300{--tw-bg-opacity:1;background-color:rgb(252 165 165 / var(--tw-bg-opacity, 1))}.bg-green-400{--tw-bg-opacity:1;background-color:rgb(74 222 128 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-900{--tw-bg-opacity:1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-900{--tw-bg-opacity:1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.p-4{padding:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 1024px){.lg\:col-span-2{grid-column:span 2 / span 2}.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}</style></head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- 輸入區域 -->
            <div class="card col-span-1">
                <h2 class="text-xl font-bold mb-4 text-gray-700">數據輸入</h2>
                
                <div class="mb-4">
                    <div class="input-container">
                        <label class="input-label">現價</label>
                        <input type="number" id="currentPrice" class="input-field" value="21650" style="text-align: center;">
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="font-medium text-gray-700 mb-2">布林通道</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="input-container">
                            <label class="input-label">上軌</label>
                            <input type="number" id="bollingerUpper" class="input-field py-1" value="21850" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">下軌</label>
                            <input type="number" id="bollingerLower" class="input-field py-1" value="21200" style="text-align: center;">
                        </div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="font-medium text-gray-700 mb-2">移動平均線</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="input-container">
                            <label class="input-label">MA10</label>
                            <input type="number" id="ma10" class="input-field py-1" value="21499" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">MA20</label>
                            <input type="number" id="ma30" class="input-field py-1" value="20442" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">MA60</label>
                            <input type="number" id="ma60" class="input-field py-1" value="19930" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">MA120</label>
                            <input type="number" id="ma120" class="input-field py-1" value="19664" style="text-align: center;">
                        </div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="font-medium text-gray-700 mb-2">近期價格區間</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="input-container">
                            <label class="input-label">近周高</label>
                            <input type="number" id="weekHigh" class="input-field py-1" value="21616" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">近周低</label>
                            <input type="number" id="weekLow" class="input-field py-1" value="21459" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">近月高</label>
                            <input type="number" id="monthHigh" class="input-field py-1" value="21736" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">近月低</label>
                            <input type="number" id="monthLow" class="input-field py-1" value="21450" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">近季高</label>
                            <input type="number" id="quarterHigh" class="input-field py-1" value="22077" style="text-align: center;">
                        </div>
                        <div class="input-container">
                            <label class="input-label">近季低</label>
                            <input type="number" id="quarterLow" class="input-field py-1" value="20925" style="text-align: center;">
                        </div>
                    </div>
                </div>
                
                <div class="update-btn-container">
                    <button id="updateBtn" class="w-1/2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors">更新分析</button>
                </div>
            </div>
            
            <!-- 圖表區域 -->
            <div class="card col-span-1 lg:col-span-2">
                <!-- 排序價格視覺化 -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <div class="flex items-center justify-center gap-2 mb-3">
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-blue-600 rounded mr-1"></div>
                            <span class="text-xs">現價</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-red-300 rounded mr-1"></div>
                            <span class="text-xs">高於現價</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-green-300 rounded mr-1"></div>
                            <span class="text-xs">低於現價</span>
                        </div>
                    </div>
                    <div id="sortedPriceChart" class="relative">
                    <div class="price-bar bg-red-900" style="width: 100%">
                        <span class="price-name ">近季高</span>
                        <span class="price-value ">22077</span>
                    </div>
                
                    <div class="price-bar bg-red-500" style="width: 90.59262329050975%">
                        <span class="price-name ">布林上軌</span>
                        <span class="price-value ">21850</span>
                    </div>
                
                    <div class="price-bar bg-red-300" style="width: 85.86821384169085%">
                        <span class="price-name ">近月高</span>
                        <span class="price-value ">21736</span>
                    </div>
                
                    <div class="price-bar bg-blue-600" style="width: 82.3041856610029%">
                        <span class="price-name text-white">現價</span>
                        <span class="price-value text-white">21650</span>
                    </div>
                
                    <div class="price-bar bg-green-300" style="width: 80.89515126398675%">
                        <span class="price-name ">近周高</span>
                        <span class="price-value ">21616</span>
                    </div>
                
                    <div class="price-bar bg-green-300" style="width: 76.04641525072525%">
                        <span class="price-name ">MA10</span>
                        <span class="price-value ">21499</span>
                    </div>
                
                    <div class="price-bar bg-green-300" style="width: 74.38872772482387%">
                        <span class="price-name ">近周低</span>
                        <span class="price-value ">21459</span>
                    </div>
                
                    <div class="price-bar bg-green-300" style="width: 74.01574803149606%">
                        <span class="price-name ">近月低</span>
                        <span class="price-value ">21450</span>
                    </div>
                
                    <div class="price-bar bg-green-300" style="width: 63.655200994612514%">
                        <span class="price-name ">布林下軌</span>
                        <span class="price-value ">21200</span>
                    </div>
                
                    <div class="price-bar bg-green-400" style="width: 52.25859925404062%">
                        <span class="price-name ">近季低</span>
                        <span class="price-value ">20925</span>
                    </div>
                
                    <div class="price-bar bg-green-600" style="width: 32.2420223787816%">
                        <span class="price-name ">MA20</span>
                        <span class="price-value ">20442</span>
                    </div>
                
                    <div class="price-bar bg-green-900" style="width: 30%">
                        <span class="price-name ">MA60</span>
                        <span class="price-value ">19930</span>
                    </div>
                
                    <div class="price-bar bg-green-900" style="width: 30%">
                        <span class="price-name ">MA120</span>
                        <span class="price-value ">19664</span>
                    </div>
                </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 布林通道分析 -->
                    <div class="card bg-gray-50">
                        <h3 class="text-lg font-semibold mb-3 text-gray-700">布林通道分析</h3>
                        <div id="bollingerAnalysis" class="space-y-2">
                <div class="analysis-item">
                    <span>布林帶</span>
                    <span class="analysis-value neutral">正常區間 (69.2%)</span>
                </div>
                <div class="analysis-item">
                    <span>中軌值</span>
                    <span class="analysis-value">21525</span>
                </div>
                <div class="analysis-item">
                    <span>帶寬</span>
                    <span class="analysis-value">650 (3.0%)</span>
                </div>
                <div class="analysis-item">
                    <span>與上軌距離</span>
                    <span class="analysis-value neutral">200 (0.92%)</span>
                </div>
                <div class="analysis-item">
                    <span>與下軌距離</span>
                    <span class="analysis-value neutral">450 (2.12%)</span>
                </div>
            </div>
                    </div>
                    
                    <!-- 移動平均線分析 -->
                    <div class="card bg-gray-50">
                        <h3 class="text-lg font-semibold mb-3 text-gray-700">移動平均線分析</h3>
                        <div id="maAnalysis" class="space-y-2">
                <div class="analysis-item">
                    <span>價格位置</span>
                    <span class="analysis-value positive">強勢多頭</span>
                </div>
                <div class="analysis-item">
                    <span>短期趨勢 (MA10-MA20)</span>
                    <span class="analysis-value positive">上升</span>
                </div>
                <div class="analysis-item">
                    <span>中期趨勢 (MA20-MA60)</span>
                    <span class="analysis-value positive">上升</span>
                </div>
                <div class="analysis-item">
                    <span>長期趨勢 (MA60-MA120)</span>
                    <span class="analysis-value positive">上升</span>
                </div>
                <div class="analysis-item">
                    <span>與MA10距離</span>
                    <span class="analysis-value positive">151 (0.70%)</span>
                </div>
            </div>
                    </div>
                    
                    <!-- 綜合分析 -->
                    <div class="card bg-gray-50 md:col-span-2">
                        <h3 class="text-lg font-semibold mb-3 text-gray-700">綜合分析</h3>
                        <div id="overallAnalysis" class="space-y-2">
                <div class="grid grid-cols-2 grid-rows-2 gap-4">
                    <div class="analysis-item">
                        <span>市場狀態</span>
                        <span class="analysis-value positive">強勢多頭</span>
                    </div>
                    <div class="analysis-item">
                        <span>近期阻力</span>
                        <span class="analysis-value">21736</span>
                    </div>
                    <div class="analysis-item">
                        <span>綜合評分</span>
                        <span class="analysis-value">92.3/100</span>
                    </div>
                    <div class="analysis-item">
                        <span>近期支撐</span>
                        <span class="analysis-value">21499</span>
                    </div>
                </div>
            </div>
                    </div>
                    
                    <!-- QR碼圖片 - 獨立卡片 -->
                    <div class="md:col-span-2 flex justify-center">
                        <div class="qr-card">
                            <a href="https://line.me/ti/p/@optionshow" target="_blank" title="加入LINE好友">
                                <img src="https://optionshow.github.io/option/LINE.png" alt="LINE QR Code" class="qr-image">
                            </a>
                            <p class="qr-text">掃描加入LINE好友</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 程式碼星號 -->
    <div class="code-star" id="codeStar"></div>

    <!-- 程式碼彈出視窗 -->
    <div class="code-modal" id="codeModal" style="display: none;">
        <div class="code-content">
            <div class="code-header">
                <h3 class="text-xl font-bold">網頁程式碼</h3>
                <span class="code-close" id="codeClose">×</span>
            </div>
            <div class="code-area" id="codeArea">&lt;html lang="zh-TW"&gt;&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;價格趨勢分析工具&lt;/title&gt;
    &lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;
    &lt;style&gt;
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f4f8;
        }
        .input-field {
            @apply px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500;
            width: 50%;
            text-align: center;
        }
        .card {
            @apply bg-white rounded-xl shadow-md p-6 transition-all duration-300;
        }
        .card:hover {
            @apply shadow-lg;
        }
        .analysis-item {
            @apply flex justify-between items-center py-2 border-b border-gray-100;
        }
        .analysis-value {
            @apply font-semibold;
        }
        .positive {
            @apply text-green-600;
        }
        .negative {
            @apply text-red-600;
        }
        .neutral {
            @apply text-gray-600;
        }
        .price-bar {
            @apply h-10 rounded-md flex items-center justify-between px-4 text-sm font-medium my-1.5;
            transition: all 0.3s ease;
        }
        .price-name {
            @apply font-medium;
        }
        .price-value {
            @apply font-bold;
        }
        .current-price {
            @apply bg-blue-600;
        }
        .code-star {
            position: fixed;
            bottom: 10px;
            left: 10px;
            opacity: 0.1;
            font-size: 24px;
            cursor: pointer;
            z-index: 1000;
            color: #333;
            transition: opacity 0.3s;
        }
        .code-star:hover {
            opacity: 0.5;
        }
        .code-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 2000;
            overflow: auto;
        }
        .code-content {
            background-color: #f8f8f8;
            margin: 5% auto;
            padding: 20px;
            width: 90%;
            max-width: 1200px;
            border-radius: 8px;
            max-height: 80vh;
            overflow: auto;
        }
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .code-close {
            font-size: 24px;
            cursor: pointer;
        }
        .code-area {
            background-color: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
        }
        .input-container {
            @apply flex items-center justify-between;
        }
        .input-label {
            @apply block text-xs text-gray-600 mb-0;
            width: 45%;
        }
        .update-btn-container {
            @apply flex justify-center;
        }
        /* Ensure number inputs are centered in all browsers */
        input[type="number"] {
            text-align: center !important;
            -moz-appearance: textfield;
        }
        /* Remove spinner buttons for Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        /* Make text on blue backgrounds white */
        .bg-blue-600 .price-name,
        .bg-blue-600 .price-value {
            color: white;
        }
        .qr-container {
            @apply flex justify-center mt-4;
        }
        .qr-card {
            @apply bg-white rounded-xl shadow-md p-4 transition-all duration-300 flex flex-col items-center;
            max-width: 180px;
        }
        .qr-card:hover {
            @apply shadow-lg;
        }
        .qr-image {
            @apply rounded-lg;
            max-width: 150px;
            transition: transform 0.3s ease;
        }
        .qr-image:hover {
            transform: scale(1.05);
        }
        .qr-text {
            @apply text-sm text-gray-600 mt-2 text-center;
        }
    &lt;/style&gt;
&lt;style&gt;*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.relative{position:relative}.col-span-1{grid-column:span 1 / span 1}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mr-1{margin-right:0.25rem}.flex{display:flex}.grid{display:grid}.h-4{height:1rem}.min-h-screen{min-height:100vh}.w-1\/2{width:50%}.w-4{width:1rem}.max-w-6xl{max-width:72rem}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-rows-2{grid-template-rows:repeat(2, minmax(0, 1fr))}.items-center{align-items:center}.justify-center{justify-content:center}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-6{gap:1.5rem}.gap-4{gap:1rem}.space-y-2 &gt; :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-green-300{--tw-bg-opacity:1;background-color:rgb(134 239 172 / var(--tw-bg-opacity, 1))}.bg-red-300{--tw-bg-opacity:1;background-color:rgb(252 165 165 / var(--tw-bg-opacity, 1))}.bg-green-400{--tw-bg-opacity:1;background-color:rgb(74 222 128 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-900{--tw-bg-opacity:1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-900{--tw-bg-opacity:1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.p-4{padding:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 1024px){.lg\:col-span-2{grid-column:span 2 / span 2}.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}&lt;/style&gt;&lt;/head&gt;
&lt;body class="min-h-screen"&gt;
    &lt;div class="container mx-auto px-4 py-8 max-w-6xl"&gt;
        &lt;div class="grid grid-cols-1 lg:grid-cols-3 gap-6"&gt;
            &lt;!-- 輸入區域 --&gt;
            &lt;div class="card col-span-1"&gt;
                &lt;h2 class="text-xl font-bold mb-4 text-gray-700"&gt;數據輸入&lt;/h2&gt;
                
                &lt;div class="mb-4"&gt;
                    &lt;div class="input-container"&gt;
                        &lt;label class="input-label"&gt;現價&lt;/label&gt;
                        &lt;input type="number" id="currentPrice" class="input-field" value="21650" style="text-align: center;"&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="mb-4"&gt;
                    &lt;h3 class="font-medium text-gray-700 mb-2"&gt;布林通道&lt;/h3&gt;
                    &lt;div class="grid grid-cols-2 gap-3"&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;上軌&lt;/label&gt;
                            &lt;input type="number" id="bollingerUpper" class="input-field py-1" value="21850" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;下軌&lt;/label&gt;
                            &lt;input type="number" id="bollingerLower" class="input-field py-1" value="21200" style="text-align: center;"&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="mb-4"&gt;
                    &lt;h3 class="font-medium text-gray-700 mb-2"&gt;移動平均線&lt;/h3&gt;
                    &lt;div class="grid grid-cols-2 gap-3"&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;MA10&lt;/label&gt;
                            &lt;input type="number" id="ma10" class="input-field py-1" value="21499" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;MA20&lt;/label&gt;
                            &lt;input type="number" id="ma30" class="input-field py-1" value="20442" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;MA60&lt;/label&gt;
                            &lt;input type="number" id="ma60" class="input-field py-1" value="19930" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;MA120&lt;/label&gt;
                            &lt;input type="number" id="ma120" class="input-field py-1" value="19664" style="text-align: center;"&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="mb-4"&gt;
                    &lt;h3 class="font-medium text-gray-700 mb-2"&gt;近期價格區間&lt;/h3&gt;
                    &lt;div class="grid grid-cols-2 gap-3"&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;近周高&lt;/label&gt;
                            &lt;input type="number" id="weekHigh" class="input-field py-1" value="21616" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;近周低&lt;/label&gt;
                            &lt;input type="number" id="weekLow" class="input-field py-1" value="21459" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;近月高&lt;/label&gt;
                            &lt;input type="number" id="monthHigh" class="input-field py-1" value="21736" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;近月低&lt;/label&gt;
                            &lt;input type="number" id="monthLow" class="input-field py-1" value="21450" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;近季高&lt;/label&gt;
                            &lt;input type="number" id="quarterHigh" class="input-field py-1" value="22077" style="text-align: center;"&gt;
                        &lt;/div&gt;
                        &lt;div class="input-container"&gt;
                            &lt;label class="input-label"&gt;近季低&lt;/label&gt;
                            &lt;input type="number" id="quarterLow" class="input-field py-1" value="20925" style="text-align: center;"&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="update-btn-container"&gt;
                    &lt;button id="updateBtn" class="w-1/2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors"&gt;更新分析&lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;!-- 圖表區域 --&gt;
            &lt;div class="card col-span-1 lg:col-span-2"&gt;
                &lt;!-- 排序價格視覺化 --&gt;
                &lt;div class="mb-6 p-4 bg-gray-50 rounded-lg"&gt;
                    &lt;div class="flex items-center justify-center gap-2 mb-3"&gt;
                        &lt;div class="flex items-center"&gt;
                            &lt;div class="w-4 h-4 bg-blue-600 rounded mr-1"&gt;&lt;/div&gt;
                            &lt;span class="text-xs"&gt;現價&lt;/span&gt;
                        &lt;/div&gt;
                        &lt;div class="flex items-center"&gt;
                            &lt;div class="w-4 h-4 bg-red-300 rounded mr-1"&gt;&lt;/div&gt;
                            &lt;span class="text-xs"&gt;高於現價&lt;/span&gt;
                        &lt;/div&gt;
                        &lt;div class="flex items-center"&gt;
                            &lt;div class="w-4 h-4 bg-green-300 rounded mr-1"&gt;&lt;/div&gt;
                            &lt;span class="text-xs"&gt;低於現價&lt;/span&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div id="sortedPriceChart" class="relative"&gt;
                    &lt;div class="price-bar bg-red-900" style="width: 100%"&gt;
                        &lt;span class="price-name "&gt;近季高&lt;/span&gt;
                        &lt;span class="price-value "&gt;22077&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-red-500" style="width: 90.59262329050975%"&gt;
                        &lt;span class="price-name "&gt;布林上軌&lt;/span&gt;
                        &lt;span class="price-value "&gt;21850&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-red-300" style="width: 85.86821384169085%"&gt;
                        &lt;span class="price-name "&gt;近月高&lt;/span&gt;
                        &lt;span class="price-value "&gt;21736&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-blue-600" style="width: 82.3041856610029%"&gt;
                        &lt;span class="price-name text-white"&gt;現價&lt;/span&gt;
                        &lt;span class="price-value text-white"&gt;21650&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-300" style="width: 80.89515126398675%"&gt;
                        &lt;span class="price-name "&gt;近周高&lt;/span&gt;
                        &lt;span class="price-value "&gt;21616&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-300" style="width: 76.04641525072525%"&gt;
                        &lt;span class="price-name "&gt;MA10&lt;/span&gt;
                        &lt;span class="price-value "&gt;21499&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-300" style="width: 74.38872772482387%"&gt;
                        &lt;span class="price-name "&gt;近周低&lt;/span&gt;
                        &lt;span class="price-value "&gt;21459&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-300" style="width: 74.01574803149606%"&gt;
                        &lt;span class="price-name "&gt;近月低&lt;/span&gt;
                        &lt;span class="price-value "&gt;21450&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-300" style="width: 63.655200994612514%"&gt;
                        &lt;span class="price-name "&gt;布林下軌&lt;/span&gt;
                        &lt;span class="price-value "&gt;21200&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-400" style="width: 52.25859925404062%"&gt;
                        &lt;span class="price-name "&gt;近季低&lt;/span&gt;
                        &lt;span class="price-value "&gt;20925&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-600" style="width: 32.2420223787816%"&gt;
                        &lt;span class="price-name "&gt;MA20&lt;/span&gt;
                        &lt;span class="price-value "&gt;20442&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-900" style="width: 30%"&gt;
                        &lt;span class="price-name "&gt;MA60&lt;/span&gt;
                        &lt;span class="price-value "&gt;19930&lt;/span&gt;
                    &lt;/div&gt;
                
                    &lt;div class="price-bar bg-green-900" style="width: 30%"&gt;
                        &lt;span class="price-name "&gt;MA120&lt;/span&gt;
                        &lt;span class="price-value "&gt;19664&lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="grid grid-cols-1 md:grid-cols-2 gap-6"&gt;
                    &lt;!-- 布林通道分析 --&gt;
                    &lt;div class="card bg-gray-50"&gt;
                        &lt;h3 class="text-lg font-semibold mb-3 text-gray-700"&gt;布林通道分析&lt;/h3&gt;
                        &lt;div id="bollingerAnalysis" class="space-y-2"&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;布林帶&lt;/span&gt;
                    &lt;span class="analysis-value neutral"&gt;正常區間 (69.2%)&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;中軌值&lt;/span&gt;
                    &lt;span class="analysis-value"&gt;21525&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;帶寬&lt;/span&gt;
                    &lt;span class="analysis-value"&gt;650 (3.0%)&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;與上軌距離&lt;/span&gt;
                    &lt;span class="analysis-value neutral"&gt;200 (0.92%)&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;與下軌距離&lt;/span&gt;
                    &lt;span class="analysis-value neutral"&gt;450 (2.12%)&lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;
                    &lt;/div&gt;
                    
                    &lt;!-- 移動平均線分析 --&gt;
                    &lt;div class="card bg-gray-50"&gt;
                        &lt;h3 class="text-lg font-semibold mb-3 text-gray-700"&gt;移動平均線分析&lt;/h3&gt;
                        &lt;div id="maAnalysis" class="space-y-2"&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;價格位置&lt;/span&gt;
                    &lt;span class="analysis-value positive"&gt;強勢多頭&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;短期趨勢 (MA10-MA20)&lt;/span&gt;
                    &lt;span class="analysis-value positive"&gt;上升&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;中期趨勢 (MA20-MA60)&lt;/span&gt;
                    &lt;span class="analysis-value positive"&gt;上升&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;長期趨勢 (MA60-MA120)&lt;/span&gt;
                    &lt;span class="analysis-value positive"&gt;上升&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;與MA10距離&lt;/span&gt;
                    &lt;span class="analysis-value positive"&gt;151 (0.70%)&lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;
                    &lt;/div&gt;
                    
                    &lt;!-- 綜合分析 --&gt;
                    &lt;div class="card bg-gray-50 md:col-span-2"&gt;
                        &lt;h3 class="text-lg font-semibold mb-3 text-gray-700"&gt;綜合分析&lt;/h3&gt;
                        &lt;div id="overallAnalysis" class="space-y-2"&gt;
                &lt;div class="grid grid-cols-2 grid-rows-2 gap-4"&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;市場狀態&lt;/span&gt;
                        &lt;span class="analysis-value positive"&gt;強勢多頭&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;近期阻力&lt;/span&gt;
                        &lt;span class="analysis-value"&gt;21736&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;綜合評分&lt;/span&gt;
                        &lt;span class="analysis-value"&gt;92.3/100&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;近期支撐&lt;/span&gt;
                        &lt;span class="analysis-value"&gt;21499&lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
                    &lt;/div&gt;
                    
                    &lt;!-- QR碼圖片 - 獨立卡片 --&gt;
                    &lt;div class="md:col-span-2 flex justify-center"&gt;
                        &lt;div class="qr-card"&gt;
                            &lt;a href="https://line.me/ti/p/@optionshow" target="_blank" title="加入LINE好友"&gt;
                                &lt;img src="https://optionshow.github.io/option/LINE.png" alt="LINE QR Code" class="qr-image"&gt;
                            &lt;/a&gt;
                            &lt;p class="qr-text"&gt;掃描加入LINE好友&lt;/p&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- 程式碼星號 --&gt;
    &lt;div class="code-star" id="codeStar"&gt;&lt;/div&gt;

    &lt;!-- 程式碼彈出視窗 --&gt;
    &lt;div class="code-modal" id="codeModal"&gt;
        &lt;div class="code-content"&gt;
            &lt;div class="code-header"&gt;
                &lt;h3 class="text-xl font-bold"&gt;網頁程式碼&lt;/h3&gt;
                &lt;span class="code-close" id="codeClose"&gt;×&lt;/span&gt;
            &lt;/div&gt;
            &lt;div class="code-area" id="codeArea"&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;script&gt;
        // 獲取所有輸入欄位
        const inputs = document.querySelectorAll('input[type="number"]');
        const updateBtn = document.getElementById('updateBtn');
        const codeStar = document.getElementById('codeStar');
        const codeModal = document.getElementById('codeModal');
        const codeClose = document.getElementById('codeClose');
        const codeArea = document.getElementById('codeArea');
        
        // 本地存儲鍵名
        const STORAGE_KEY = 'priceAnalysisData';
        
        // 初始化頁面
        document.addEventListener('DOMContentLoaded', function() {
            // 從本地存儲加載數據
            loadDataFromLocalStorage();
            
            // 更新分析
            updateAnalysis();
            
            // 為所有輸入欄位添加事件監聽
            inputs.forEach(input =&gt; {
                input.addEventListener('change', function() {
                    updateAnalysis();
                    saveDataToLocalStorage();
                });
                // 確保所有輸入欄位都是置中的
                input.style.textAlign = 'center';
            });
            
            // 更新按鈕事件
            updateBtn.addEventListener('click', function() {
                updateAnalysis();
                saveDataToLocalStorage();
            });
            
            // 程式碼星號點擊事件
            codeStar.addEventListener('click', function() {
                // 獲取當前頁面的HTML
                const htmlContent = document.documentElement.outerHTML;
                // 顯示在彈出視窗中
                codeArea.textContent = htmlContent;
                codeModal.style.display = 'block';
            });
            
            // 關閉彈出視窗
            codeClose.addEventListener('click', function() {
                codeModal.style.display = 'none';
            });
            
            // 點擊彈出視窗外部關閉
            window.addEventListener('click', function(event) {
                if (event.target === codeModal) {
                    codeModal.style.display = 'none';
                }
            });
        });
        
        // 從本地存儲加載數據
        function loadDataFromLocalStorage() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    // 將保存的數據填充到輸入欄位
                    for (const key in data) {
                        const input = document.getElementById(key);
                        if (input) {
                            input.value = data[key];
                        }
                    }
                }
            } catch (error) {
                console.error('從本地存儲加載數據時出錯:', error);
            }
        }
        
        // 保存數據到本地存儲
        function saveDataToLocalStorage() {
            try {
                const data = {};
                
                // 收集所有輸入欄位的值
                inputs.forEach(input =&gt; {
                    data[input.id] = input.value;
                });
                
                // 保存到本地存儲
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            } catch (error) {
                console.error('保存數據到本地存儲時出錯:', error);
            }
        }
        
        // 更新分析
        function updateAnalysis() {
            // 獲取所有輸入值
            const currentPrice = parseFloat(document.getElementById('currentPrice').value);
            const bollingerUpper = parseFloat(document.getElementById('bollingerUpper').value);
            const bollingerLower = parseFloat(document.getElementById('bollingerLower').value);
            const ma10 = parseFloat(document.getElementById('ma10').value);
            const ma30 = parseFloat(document.getElementById('ma30').value);
            const ma60 = parseFloat(document.getElementById('ma60').value);
            const ma120 = parseFloat(document.getElementById('ma120').value);
            const weekHigh = parseFloat(document.getElementById('weekHigh').value);
            const weekLow = parseFloat(document.getElementById('weekLow').value);
            const monthHigh = parseFloat(document.getElementById('monthHigh').value);
            const monthLow = parseFloat(document.getElementById('monthLow').value);
            const quarterHigh = parseFloat(document.getElementById('quarterHigh').value);
            const quarterLow = parseFloat(document.getElementById('quarterLow').value);
            
            // 更新排序價格視覺化
            updateSortedPriceChart(
                currentPrice, 
                bollingerUpper, bollingerLower, 
                ma10, ma30, ma60, ma120, 
                weekHigh, weekLow, 
                monthHigh, monthLow, 
                quarterHigh, quarterLow
            );
            
            // 更新布林通道分析
            updateBollingerAnalysis(currentPrice, bollingerUpper, bollingerLower);
            
            // 更新移動平均線分析
            updateMAAnalysis(currentPrice, ma10, ma30, ma60, ma120);
            
            // 更新綜合分析
            updateOverallAnalysis(currentPrice, bollingerUpper, bollingerLower, ma10, ma30, ma60, ma120, weekHigh, weekLow, monthHigh, monthLow, quarterHigh, quarterLow);
        }
        
        // 更新排序價格視覺化
        function updateSortedPriceChart(currentPrice, bollingerUpper, bollingerLower, ma10, ma30, ma60, ma120, weekHigh, weekLow, monthHigh, monthLow, quarterHigh, quarterLow) {
            const sortedPriceChart = document.getElementById('sortedPriceChart');
            
            // 創建價格數據陣列
            const priceData = [
                { name: "現價", value: currentPrice, type: "current" },
                { name: "布林上軌", value: bollingerUpper, type: "indicator" },
                { name: "布林下軌", value: bollingerLower, type: "indicator" },
                { name: "MA10", value: ma10, type: "indicator" },
                { name: "MA20", value: ma30, type: "indicator" },
                { name: "MA60", value: ma60, type: "indicator" },
                { name: "MA120", value: ma120, type: "indicator" },
                { name: "近周高", value: weekHigh, type: "indicator" },
                { name: "近周低", value: weekLow, type: "indicator" },
                { name: "近月高", value: monthHigh, type: "indicator" },
                { name: "近月低", value: monthLow, type: "indicator" },
                { name: "近季高", value: quarterHigh, type: "indicator" },
                { name: "近季低", value: quarterLow, type: "indicator" }
            ];
            
            // 排序價格數據（從高到低）
            priceData.sort((a, b) =&gt; b.value - a.value);
            
            // 找出最大和最小值，用於計算比例
            const maxValue = Math.max(...priceData.map(item =&gt; item.value));
            const minValue = Math.min(...priceData.map(item =&gt; item.value));
            const range = maxValue - minValue;
            
            // 找出高於和低於現價的最大差距，用於計算顏色漸層
            const aboveItems = priceData.filter(item =&gt; item.value &gt; currentPrice);
            const belowItems = priceData.filter(item =&gt; item.value &lt; currentPrice);
            
            const maxAboveDiff = aboveItems.length &gt; 0 ? Math.max(...aboveItems.map(item =&gt; item.value - currentPrice)) : 0;
            const maxBelowDiff = belowItems.length &gt; 0 ? Math.max(...belowItems.map(item =&gt; currentPrice - item.value)) : 0;
            
            // 生成HTML
            let html = '';
            priceData.forEach(item =&gt; {
                const width = Math.max(30, ((item.value - minValue) / range) * 100);
                let bgColor;
                let textColorClass = '';
                
                if (item.type === "current") {
                    bgColor = "bg-blue-600"; // 現價用藍色
                    textColorClass = 'text-white'; // 藍色背景使用白色文字
                } else if (item.value &gt; currentPrice) {
                    // 高於現價用紅色漸層
                    const intensity = ((item.value - currentPrice) / maxAboveDiff) * 100;
                    const redIntensity = Math.min(90, Math.max(30, intensity));
                    bgColor = `bg-red-${Math.round(redIntensity / 10) * 100}`;
                } else {
                    // 低於現價用綠色漸層
                    const intensity = ((currentPrice - item.value) / maxBelowDiff) * 100;
                    const greenIntensity = Math.min(90, Math.max(30, intensity));
                    bgColor = `bg-green-${Math.round(greenIntensity / 10) * 100}`;
                }
                
                html += `
                    &lt;div class="price-bar ${bgColor}" style="width: ${width}%"&gt;
                        &lt;span class="price-name ${textColorClass}"&gt;${item.name}&lt;/span&gt;
                        &lt;span class="price-value ${textColorClass}"&gt;${item.value.toFixed(0)}&lt;/span&gt;
                    &lt;/div&gt;
                `;
            });
            
            sortedPriceChart.innerHTML = html;
        }
        
        // 更新布林通道分析
        function updateBollingerAnalysis(currentPrice, upper, lower) {
            const bollingerAnalysis = document.getElementById('bollingerAnalysis');
            const middle = (upper + lower) / 2;
            const width = upper - lower;
            const percentInBand = ((currentPrice - lower) / width) * 100;
            
            let status, statusClass;
            if (currentPrice &gt; upper) {
                status = "超買";
                statusClass = "negative";
            } else if (currentPrice &lt; lower) {
                status = "超賣";
                statusClass = "positive";
            } else if (percentInBand &gt; 70) {
                status = "接近超買";
                statusClass = "negative";
            } else if (percentInBand &lt; 30) {
                status = "接近超賣";
                statusClass = "positive";
            } else {
                status = "正常區間";
                statusClass = "neutral";
            }
            
            bollingerAnalysis.innerHTML = `
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;布林帶&lt;/span&gt;
                    &lt;span class="analysis-value ${statusClass}"&gt;${status} (${percentInBand.toFixed(1)}%)&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;中軌值&lt;/span&gt;
                    &lt;span class="analysis-value"&gt;${middle.toFixed(0)}&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;帶寬&lt;/span&gt;
                    &lt;span class="analysis-value"&gt;${width.toFixed(0)} (${(width/middle*100).toFixed(1)}%)&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;與上軌距離&lt;/span&gt;
                    &lt;span class="analysis-value ${currentPrice &gt; upper ? 'negative' : 'neutral'}"&gt;${Math.abs(currentPrice - upper).toFixed(0)} (${((Math.abs(currentPrice - upper)/upper)*100).toFixed(2)}%)&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;與下軌距離&lt;/span&gt;
                    &lt;span class="analysis-value ${currentPrice &lt; lower ? 'negative' : 'neutral'}"&gt;${Math.abs(currentPrice - lower).toFixed(0)} (${((Math.abs(currentPrice - lower)/lower)*100).toFixed(2)}%)&lt;/span&gt;
                &lt;/div&gt;
            `;
        }
        
        // 更新移動平均線分析
        function updateMAAnalysis(currentPrice, ma10, ma30, ma60, ma120) {
            const maAnalysis = document.getElementById('maAnalysis');
            
            // 計算趨勢
            const shortTrend = ma10 &gt; ma30 ? "上升" : (ma10 &lt; ma30 ? "下降" : "持平");
            const midTrend = ma30 &gt; ma60 ? "上升" : (ma30 &lt; ma60 ? "下降" : "持平");
            const longTrend = ma60 &gt; ma120 ? "上升" : (ma60 &lt; ma120 ? "下降" : "持平");
            
            // 計算價格相對於均線的位置
            const aboveCount = [ma10, ma30, ma60, ma120].filter(ma =&gt; currentPrice &gt; ma).length;
            let position;
            let positionClass;
            
            if (aboveCount === 4) {
                position = "強勢多頭";
                positionClass = "positive";
            } else if (aboveCount === 3) {
                position = "多頭";
                positionClass = "positive";
            } else if (aboveCount === 2) {
                position = "中性";
                positionClass = "neutral";
            } else if (aboveCount === 1) {
                position = "空頭";
                positionClass = "negative";
            } else {
                position = "強勢空頭";
                positionClass = "negative";
            }
            
            // 計算與MA10的距離百分比
            const ma10Distance = Math.abs(currentPrice - ma10);
            const ma10DistancePercent = (ma10Distance / currentPrice) * 100;
            
            maAnalysis.innerHTML = `
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;價格位置&lt;/span&gt;
                    &lt;span class="analysis-value ${positionClass}"&gt;${position}&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;短期趨勢 (MA10-MA20)&lt;/span&gt;
                    &lt;span class="analysis-value ${shortTrend === "上升" ? "positive" : (shortTrend === "下降" ? "negative" : "neutral")}"&gt;${shortTrend}&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;中期趨勢 (MA20-MA60)&lt;/span&gt;
                    &lt;span class="analysis-value ${midTrend === "上升" ? "positive" : (midTrend === "下降" ? "negative" : "neutral")}"&gt;${midTrend}&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;長期趨勢 (MA60-MA120)&lt;/span&gt;
                    &lt;span class="analysis-value ${longTrend === "上升" ? "positive" : (longTrend === "下降" ? "negative" : "neutral")}"&gt;${longTrend}&lt;/span&gt;
                &lt;/div&gt;
                &lt;div class="analysis-item"&gt;
                    &lt;span&gt;與MA10距離&lt;/span&gt;
                    &lt;span class="analysis-value ${currentPrice &gt; ma10 ? "positive" : "negative"}"&gt;${ma10Distance.toFixed(0)} (${ma10DistancePercent.toFixed(2)}%)&lt;/span&gt;
                &lt;/div&gt;
            `;
        }
        
        // 更新綜合分析
        function updateOverallAnalysis(currentPrice, bollingerUpper, bollingerLower, ma10, ma30, ma60, ma120, weekHigh, weekLow, monthHigh, monthLow, quarterHigh, quarterLow) {
            const overallAnalysis = document.getElementById('overallAnalysis');
            
            // 計算各種指標
            const bollingerMiddle = (bollingerUpper + bollingerLower) / 2;
            const aboveMACount = [ma10, ma30, ma60, ma120].filter(ma =&gt; currentPrice &gt; ma).length;
            const aboveRangeCount = [
                currentPrice &gt; (weekHigh + weekLow) / 2,
                currentPrice &gt; (monthHigh + monthLow) / 2,
                currentPrice &gt; (quarterHigh + quarterLow) / 2
            ].filter(Boolean).length;
            
            // 綜合評分 (0-100)
            let score = 0;
            
            // 布林通道評分 (0-25)
            const bollingerPercent = (currentPrice - bollingerLower) / (bollingerUpper - bollingerLower);
            let bollingerScore = 0;
            if (currentPrice &gt; bollingerUpper) {
                bollingerScore = 25; // 超買
            } else if (currentPrice &lt; bollingerLower) {
                bollingerScore = 0; // 超賣
            } else {
                bollingerScore = bollingerPercent * 25; // 在通道內
            }
            
            // 均線評分 (0-25)
            const maScore = (aboveMACount / 4) * 25;
            
            // 區間評分 (0-25)
            const rangeScore = (aboveRangeCount / 3) * 25;
            
            // 趨勢評分 (0-25)
            let trendScore = 0;
            if (ma10 &gt; ma30 &amp;&amp; ma30 &gt; ma60 &amp;&amp; ma60 &gt; ma120) {
                trendScore = 25; // 強勢上升
            } else if (ma10 &lt; ma30 &amp;&amp; ma30 &lt; ma60 &amp;&amp; ma60 &lt; ma120) {
                trendScore = 0; // 強勢下降
            } else if (ma10 &gt; ma30 &amp;&amp; ma30 &gt; ma60) {
                trendScore = 20; // 中期上升
            } else if (ma10 &lt; ma30 &amp;&amp; ma30 &lt; ma60) {
                trendScore = 5; // 中期下降
            } else if (ma10 &gt; ma30) {
                trendScore = 15; // 短期上升
            } else if (ma10 &lt; ma30) {
                trendScore = 10; // 短期下降
            } else {
                trendScore = 12.5; // 中性
            }
            
            // 總評分
            score = bollingerScore + maScore + rangeScore + trendScore;
            
            // 市場狀態
            let marketStatus, marketClass;
            if (score &gt;= 80) {
                marketStatus = "強勢多頭";
                marketClass = "positive";
            } else if (score &gt;= 60) {
                marketStatus = "多頭";
                marketClass = "positive";
            } else if (score &gt;= 40) {
                marketStatus = "中性偏多";
                marketClass = "neutral";
            } else if (score &gt;= 20) {
                marketStatus = "中性偏空";
                marketClass = "neutral";
            } else {
                marketStatus = "空頭";
                marketClass = "negative";
            }
            
            // 支撐與阻力
            const supports = [ma10, ma30, bollingerLower, weekLow, monthLow].filter(s =&gt; s &lt; currentPrice).sort((a, b) =&gt; b - a);
            const resistances = [ma10, ma30, bollingerUpper, weekHigh, monthHigh].filter(r =&gt; r &gt; currentPrice).sort((a, b) =&gt; a - b);
            
            const nearestSupport = supports.length &gt; 0 ? supports[0] : quarterLow;
            const nearestResistance = resistances.length &gt; 0 ? resistances[0] : quarterHigh;
            
            // 更新綜合分析，使用2x2布局，並交換綜合評分和近期阻力位的位置
            overallAnalysis.innerHTML = `
                &lt;div class="grid grid-cols-2 grid-rows-2 gap-4"&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;市場狀態&lt;/span&gt;
                        &lt;span class="analysis-value ${marketClass}"&gt;${marketStatus}&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;近期阻力&lt;/span&gt;
                        &lt;span class="analysis-value"&gt;${nearestResistance.toFixed(0)}&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;綜合評分&lt;/span&gt;
                        &lt;span class="analysis-value"&gt;${score.toFixed(1)}/100&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class="analysis-item"&gt;
                        &lt;span&gt;近期支撐&lt;/span&gt;
                        &lt;span class="analysis-value"&gt;${nearestSupport.toFixed(0)}&lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            `;
        }
    &lt;/script&gt;
&lt;script&gt;(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'94b027a93457f23c',t:'MTc0OTEzMTU5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&amp;&amp;(document.onreadystatechange=e,c())}}}})();&lt;/script&gt;&lt;iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"&gt;&lt;/iframe&gt;

&lt;/body&gt;&lt;/html&gt;</div>
        </div>
    </div>

    <script>
        // 獲取所有輸入欄位
        const inputs = document.querySelectorAll('input[type="number"]');
        const updateBtn = document.getElementById('updateBtn');
        const codeStar = document.getElementById('codeStar');
        const codeModal = document.getElementById('codeModal');
        const codeClose = document.getElementById('codeClose');
        const codeArea = document.getElementById('codeArea');
        
        // 本地存儲鍵名
        const STORAGE_KEY = 'priceAnalysisData';
        
        // 初始化頁面
        document.addEventListener('DOMContentLoaded', function() {
            // 從本地存儲加載數據
            loadDataFromLocalStorage();
            
            // 更新分析
            updateAnalysis();
            
            // 為所有輸入欄位添加事件監聽
            inputs.forEach(input => {
                input.addEventListener('change', function() {
                    updateAnalysis();
                    saveDataToLocalStorage();
                });
                // 確保所有輸入欄位都是置中的
                input.style.textAlign = 'center';
            });
            
            // 更新按鈕事件
            updateBtn.addEventListener('click', function() {
                updateAnalysis();
                saveDataToLocalStorage();
            });
            
            // 程式碼星號點擊事件
            codeStar.addEventListener('click', function() {
                // 獲取當前頁面的HTML
                const htmlContent = document.documentElement.outerHTML;
                // 顯示在彈出視窗中
                codeArea.textContent = htmlContent;
                codeModal.style.display = 'block';
            });
            
            // 關閉彈出視窗
            codeClose.addEventListener('click', function() {
                codeModal.style.display = 'none';
            });
            
            // 點擊彈出視窗外部關閉
            window.addEventListener('click', function(event) {
                if (event.target === codeModal) {
                    codeModal.style.display = 'none';
                }
            });
        });
        
        // 從本地存儲加載數據
        function loadDataFromLocalStorage() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    // 將保存的數據填充到輸入欄位
                    for (const key in data) {
                        const input = document.getElementById(key);
                        if (input) {
                            input.value = data[key];
                        }
                    }
                }
            } catch (error) {
                console.error('從本地存儲加載數據時出錯:', error);
            }
        }
        
        // 保存數據到本地存儲
        function saveDataToLocalStorage() {
            try {
                const data = {};
                
                // 收集所有輸入欄位的值
                inputs.forEach(input => {
                    data[input.id] = input.value;
                });
                
                // 保存到本地存儲
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            } catch (error) {
                console.error('保存數據到本地存儲時出錯:', error);
            }
        }
        
        // 更新分析
        function updateAnalysis() {
            // 獲取所有輸入值
            const currentPrice = parseFloat(document.getElementById('currentPrice').value);
            const bollingerUpper = parseFloat(document.getElementById('bollingerUpper').value);
            const bollingerLower = parseFloat(document.getElementById('bollingerLower').value);
            const ma10 = parseFloat(document.getElementById('ma10').value);
            const ma30 = parseFloat(document.getElementById('ma30').value);
            const ma60 = parseFloat(document.getElementById('ma60').value);
            const ma120 = parseFloat(document.getElementById('ma120').value);
            const weekHigh = parseFloat(document.getElementById('weekHigh').value);
            const weekLow = parseFloat(document.getElementById('weekLow').value);
            const monthHigh = parseFloat(document.getElementById('monthHigh').value);
            const monthLow = parseFloat(document.getElementById('monthLow').value);
            const quarterHigh = parseFloat(document.getElementById('quarterHigh').value);
            const quarterLow = parseFloat(document.getElementById('quarterLow').value);
            
            // 更新排序價格視覺化
            updateSortedPriceChart(
                currentPrice, 
                bollingerUpper, bollingerLower, 
                ma10, ma30, ma60, ma120, 
                weekHigh, weekLow, 
                monthHigh, monthLow, 
                quarterHigh, quarterLow
            );
            
            // 更新布林通道分析
            updateBollingerAnalysis(currentPrice, bollingerUpper, bollingerLower);
            
            // 更新移動平均線分析
            updateMAAnalysis(currentPrice, ma10, ma30, ma60, ma120);
            
            // 更新綜合分析
            updateOverallAnalysis(currentPrice, bollingerUpper, bollingerLower, ma10, ma30, ma60, ma120, weekHigh, weekLow, monthHigh, monthLow, quarterHigh, quarterLow);
        }
        
        // 更新排序價格視覺化
        function updateSortedPriceChart(currentPrice, bollingerUpper, bollingerLower, ma10, ma30, ma60, ma120, weekHigh, weekLow, monthHigh, monthLow, quarterHigh, quarterLow) {
            const sortedPriceChart = document.getElementById('sortedPriceChart');
            
            // 創建價格數據陣列
            const priceData = [
                { name: "現價", value: currentPrice, type: "current" },
                { name: "布林上軌", value: bollingerUpper, type: "indicator" },
                { name: "布林下軌", value: bollingerLower, type: "indicator" },
                { name: "MA10", value: ma10, type: "indicator" },
                { name: "MA20", value: ma30, type: "indicator" },
                { name: "MA60", value: ma60, type: "indicator" },
                { name: "MA120", value: ma120, type: "indicator" },
                { name: "近周高", value: weekHigh, type: "indicator" },
                { name: "近周低", value: weekLow, type: "indicator" },
                { name: "近月高", value: monthHigh, type: "indicator" },
                { name: "近月低", value: monthLow, type: "indicator" },
                { name: "近季高", value: quarterHigh, type: "indicator" },
                { name: "近季低", value: quarterLow, type: "indicator" }
            ];
            
            // 排序價格數據（從高到低）
            priceData.sort((a, b) => b.value - a.value);
            
            // 找出最大和最小值，用於計算比例
            const maxValue = Math.max(...priceData.map(item => item.value));
            const minValue = Math.min(...priceData.map(item => item.value));
            const range = maxValue - minValue;
            
            // 找出高於和低於現價的最大差距，用於計算顏色漸層
            const aboveItems = priceData.filter(item => item.value > currentPrice);
            const belowItems = priceData.filter(item => item.value < currentPrice);
            
            const maxAboveDiff = aboveItems.length > 0 ? Math.max(...aboveItems.map(item => item.value - currentPrice)) : 0;
            const maxBelowDiff = belowItems.length > 0 ? Math.max(...belowItems.map(item => currentPrice - item.value)) : 0;
            
            // 生成HTML
            let html = '';
            priceData.forEach(item => {
                const width = Math.max(30, ((item.value - minValue) / range) * 100);
                let bgColor;
                let textColorClass = '';
                
                if (item.type === "current") {
                    bgColor = "bg-blue-600"; // 現價用藍色
                    textColorClass = 'text-white'; // 藍色背景使用白色文字
                } else if (item.value > currentPrice) {
                    // 高於現價用紅色漸層
                    const intensity = ((item.value - currentPrice) / maxAboveDiff) * 100;
                    const redIntensity = Math.min(90, Math.max(30, intensity));
                    bgColor = `bg-red-${Math.round(redIntensity / 10) * 100}`;
                } else {
                    // 低於現價用綠色漸層
                    const intensity = ((currentPrice - item.value) / maxBelowDiff) * 100;
                    const greenIntensity = Math.min(90, Math.max(30, intensity));
                    bgColor = `bg-green-${Math.round(greenIntensity / 10) * 100}`;
                }
                
                html += `
                    <div class="price-bar ${bgColor}" style="width: ${width}%">
                        <span class="price-name ${textColorClass}">${item.name}</span>
                        <span class="price-value ${textColorClass}">${item.value.toFixed(0)}</span>
                    </div>
                `;
            });
            
            sortedPriceChart.innerHTML = html;
        }
        
        // 更新布林通道分析
        function updateBollingerAnalysis(currentPrice, upper, lower) {
            const bollingerAnalysis = document.getElementById('bollingerAnalysis');
            const middle = (upper + lower) / 2;
            const width = upper - lower;
            const percentInBand = ((currentPrice - lower) / width) * 100;
            
            let status, statusClass;
            if (currentPrice > upper) {
                status = "超買";
                statusClass = "negative";
            } else if (currentPrice < lower) {
                status = "超賣";
                statusClass = "positive";
            } else if (percentInBand > 70) {
                status = "接近超買";
                statusClass = "negative";
            } else if (percentInBand < 30) {
                status = "接近超賣";
                statusClass = "positive";
            } else {
                status = "正常區間";
                statusClass = "neutral";
            }
            
            bollingerAnalysis.innerHTML = `
                <div class="analysis-item">
                    <span>布林帶</span>
                    <span class="analysis-value ${statusClass}">${status} (${percentInBand.toFixed(1)}%)</span>
                </div>
                <div class="analysis-item">
                    <span>中軌值</span>
                    <span class="analysis-value">${middle.toFixed(0)}</span>
                </div>
                <div class="analysis-item">
                    <span>帶寬</span>
                    <span class="analysis-value">${width.toFixed(0)} (${(width/middle*100).toFixed(1)}%)</span>
                </div>
                <div class="analysis-item">
                    <span>與上軌距離</span>
                    <span class="analysis-value ${currentPrice > upper ? 'negative' : 'neutral'}">${Math.abs(currentPrice - upper).toFixed(0)} (${((Math.abs(currentPrice - upper)/upper)*100).toFixed(2)}%)</span>
                </div>
                <div class="analysis-item">
                    <span>與下軌距離</span>
                    <span class="analysis-value ${currentPrice < lower ? 'negative' : 'neutral'}">${Math.abs(currentPrice - lower).toFixed(0)} (${((Math.abs(currentPrice - lower)/lower)*100).toFixed(2)}%)</span>
                </div>
            `;
        }
        
        // 更新移動平均線分析
        function updateMAAnalysis(currentPrice, ma10, ma30, ma60, ma120) {
            const maAnalysis = document.getElementById('maAnalysis');
            
            // 計算趨勢
            const shortTrend = ma10 > ma30 ? "上升" : (ma10 < ma30 ? "下降" : "持平");
            const midTrend = ma30 > ma60 ? "上升" : (ma30 < ma60 ? "下降" : "持平");
            const longTrend = ma60 > ma120 ? "上升" : (ma60 < ma120 ? "下降" : "持平");
            
            // 計算價格相對於均線的位置
            const aboveCount = [ma10, ma30, ma60, ma120].filter(ma => currentPrice > ma).length;
            let position;
            let positionClass;
            
            if (aboveCount === 4) {
                position = "強勢多頭";
                positionClass = "positive";
            } else if (aboveCount === 3) {
                position = "多頭";
                positionClass = "positive";
            } else if (aboveCount === 2) {
                position = "中性";
                positionClass = "neutral";
            } else if (aboveCount === 1) {
                position = "空頭";
                positionClass = "negative";
            } else {
                position = "強勢空頭";
                positionClass = "negative";
            }
            
            // 計算與MA10的距離百分比
            const ma10Distance = Math.abs(currentPrice - ma10);
            const ma10DistancePercent = (ma10Distance / currentPrice) * 100;
            
            maAnalysis.innerHTML = `
                <div class="analysis-item">
                    <span>價格位置</span>
                    <span class="analysis-value ${positionClass}">${position}</span>
                </div>
                <div class="analysis-item">
                    <span>短期趨勢 (MA10-MA20)</span>
                    <span class="analysis-value ${shortTrend === "上升" ? "positive" : (shortTrend === "下降" ? "negative" : "neutral")}">${shortTrend}</span>
                </div>
                <div class="analysis-item">
                    <span>中期趨勢 (MA20-MA60)</span>
                    <span class="analysis-value ${midTrend === "上升" ? "positive" : (midTrend === "下降" ? "negative" : "neutral")}">${midTrend}</span>
                </div>
                <div class="analysis-item">
                    <span>長期趨勢 (MA60-MA120)</span>
                    <span class="analysis-value ${longTrend === "上升" ? "positive" : (longTrend === "下降" ? "negative" : "neutral")}">${longTrend}</span>
                </div>
                <div class="analysis-item">
                    <span>與MA10距離</span>
                    <span class="analysis-value ${currentPrice > ma10 ? "positive" : "negative"}">${ma10Distance.toFixed(0)} (${ma10DistancePercent.toFixed(2)}%)</span>
                </div>
            `;
        }
        
        // 更新綜合分析
        function updateOverallAnalysis(currentPrice, bollingerUpper, bollingerLower, ma10, ma30, ma60, ma120, weekHigh, weekLow, monthHigh, monthLow, quarterHigh, quarterLow) {
            const overallAnalysis = document.getElementById('overallAnalysis');
            
            // 計算各種指標
            const bollingerMiddle = (bollingerUpper + bollingerLower) / 2;
            const aboveMACount = [ma10, ma30, ma60, ma120].filter(ma => currentPrice > ma).length;
            const aboveRangeCount = [
                currentPrice > (weekHigh + weekLow) / 2,
                currentPrice > (monthHigh + monthLow) / 2,
                currentPrice > (quarterHigh + quarterLow) / 2
            ].filter(Boolean).length;
            
            // 綜合評分 (0-100)
            let score = 0;
            
            // 布林通道評分 (0-25)
            const bollingerPercent = (currentPrice - bollingerLower) / (bollingerUpper - bollingerLower);
            let bollingerScore = 0;
            if (currentPrice > bollingerUpper) {
                bollingerScore = 25; // 超買
            } else if (currentPrice < bollingerLower) {
                bollingerScore = 0; // 超賣
            } else {
                bollingerScore = bollingerPercent * 25; // 在通道內
            }
            
            // 均線評分 (0-25)
            const maScore = (aboveMACount / 4) * 25;
            
            // 區間評分 (0-25)
            const rangeScore = (aboveRangeCount / 3) * 25;
            
            // 趨勢評分 (0-25)
            let trendScore = 0;
            if (ma10 > ma30 && ma30 > ma60 && ma60 > ma120) {
                trendScore = 25; // 強勢上升
            } else if (ma10 < ma30 && ma30 < ma60 && ma60 < ma120) {
                trendScore = 0; // 強勢下降
            } else if (ma10 > ma30 && ma30 > ma60) {
                trendScore = 20; // 中期上升
            } else if (ma10 < ma30 && ma30 < ma60) {
                trendScore = 5; // 中期下降
            } else if (ma10 > ma30) {
                trendScore = 15; // 短期上升
            } else if (ma10 < ma30) {
                trendScore = 10; // 短期下降
            } else {
                trendScore = 12.5; // 中性
            }
            
            // 總評分
            score = bollingerScore + maScore + rangeScore + trendScore;
            
            // 市場狀態
            let marketStatus, marketClass;
            if (score >= 80) {
                marketStatus = "強勢多頭";
                marketClass = "positive";
            } else if (score >= 60) {
                marketStatus = "多頭";
                marketClass = "positive";
            } else if (score >= 40) {
                marketStatus = "中性偏多";
                marketClass = "neutral";
            } else if (score >= 20) {
                marketStatus = "中性偏空";
                marketClass = "neutral";
            } else {
                marketStatus = "空頭";
                marketClass = "negative";
            }
            
            // 支撐與阻力
            const supports = [ma10, ma30, bollingerLower, weekLow, monthLow].filter(s => s < currentPrice).sort((a, b) => b - a);
            const resistances = [ma10, ma30, bollingerUpper, weekHigh, monthHigh].filter(r => r > currentPrice).sort((a, b) => a - b);
            
            const nearestSupport = supports.length > 0 ? supports[0] : quarterLow;
            const nearestResistance = resistances.length > 0 ? resistances[0] : quarterHigh;
            
            // 更新綜合分析，使用2x2布局，並交換綜合評分和近期阻力位的位置
            overallAnalysis.innerHTML = `
                <div class="grid grid-cols-2 grid-rows-2 gap-4">
                    <div class="analysis-item">
                        <span>市場狀態</span>
                        <span class="analysis-value ${marketClass}">${marketStatus}</span>
                    </div>
                    <div class="analysis-item">
                        <span>近期阻力</span>
                        <span class="analysis-value">${nearestResistance.toFixed(0)}</span>
                    </div>
                    <div class="analysis-item">
                        <span>綜合評分</span>
                        <span class="analysis-value">${score.toFixed(1)}/100</span>
                    </div>
                    <div class="analysis-item">
                        <span>近期支撐</span>
                        <span class="analysis-value">${nearestSupport.toFixed(0)}</span>
                    </div>
                </div>
            `;
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'94b027a93457f23c',t:'MTc0OTEzMTU5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>

</body></html>