<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>重點履約價互動式圖表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chart-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .input-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .chart-area {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.pointer-events-none{pointer-events:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.bottom-4{bottom:1rem}.left-4{left:1rem}.z-10{z-index:10}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mr-2{margin-right:0.5rem}.mt-3{margin-top:0.75rem}.block{display:block}.flex{display:flex}.grid{display:grid}.h-1{height:0.25rem}.min-h-screen{min-height:100vh}.w-4{width:1rem}.w-full{width:100%}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.items-center{align-items:center}.justify-between{justify-content:space-between}.gap-6{gap:1.5rem}.space-x-4 > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity:1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-red-200{--tw-border-opacity:1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-6{padding:1.5rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.text-center{text-align:center}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.opacity-0{opacity:0}.opacity-10{opacity:0.1}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-200{transition-duration:200ms}.hover\:opacity-30:hover{opacity:0.3}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-1:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}.focus\:ring-green-400:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(74 222 128 / var(--tw-ring-opacity, 1))}.focus\:ring-red-400:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(248 113 113 / var(--tw-ring-opacity, 1))}@media (min-width: 1024px){.lg\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}}</style></head>
<body class="min-h-screen chart-container">
    <div class="container mx-auto p-6">
        <h1 class="text-3xl font-bold text-white text-center mb-8">重點履約價互動式圖表</h1>
        
        <!-- 輸入區域 -->
        <div class="input-section rounded-xl p-6 mb-8 shadow-2xl">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">設定到期日與履約價</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                <!-- 到期日1-5 -->
                <div class="expiry-group" data-index="0">
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">到期日 1</label>
                        <input type="text" placeholder="月/日" class="expiry-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="space-y-2">
                        <div class="text-sm font-medium text-red-600">Call (壓力)</div>
                        <input type="number" placeholder="Call 1" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 2" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 3" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 4" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 5" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 6" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        
                        <div class="text-sm font-medium text-green-600 mt-3">Put (支撐)</div>
                        <input type="number" placeholder="Put 1" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 2" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 3" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 4" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 5" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 6" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                    </div>
                </div>

                <div class="expiry-group" data-index="1">
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">到期日 2</label>
                        <input type="text" placeholder="月/日" class="expiry-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="space-y-2">
                        <div class="text-sm font-medium text-red-600">Call (壓力)</div>
                        <input type="number" placeholder="Call 1" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 2" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 3" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 4" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 5" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 6" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        
                        <div class="text-sm font-medium text-green-600 mt-3">Put (支撐)</div>
                        <input type="number" placeholder="Put 1" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 2" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 3" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 4" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 5" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 6" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                    </div>
                </div>

                <div class="expiry-group" data-index="2">
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">到期日 3</label>
                        <input type="text" placeholder="月/日" class="expiry-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="space-y-2">
                        <div class="text-sm font-medium text-red-600">Call (壓力)</div>
                        <input type="number" placeholder="Call 1" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 2" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 3" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 4" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 5" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 6" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        
                        <div class="text-sm font-medium text-green-600 mt-3">Put (支撐)</div>
                        <input type="number" placeholder="Put 1" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 2" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 3" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 4" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 5" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 6" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                    </div>
                </div>

                <div class="expiry-group" data-index="3">
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">到期日 4</label>
                        <input type="text" placeholder="月/日" class="expiry-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="space-y-2">
                        <div class="text-sm font-medium text-red-600">Call (壓力)</div>
                        <input type="number" placeholder="Call 1" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 2" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 3" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 4" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 5" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 6" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        
                        <div class="text-sm font-medium text-green-600 mt-3">Put (支撐)</div>
                        <input type="number" placeholder="Put 1" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 2" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 3" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 4" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 5" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 6" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                    </div>
                </div>

                <div class="expiry-group" data-index="4">
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">到期日 5</label>
                        <input type="text" placeholder="月/日" class="expiry-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="space-y-2">
                        <div class="text-sm font-medium text-red-600">Call (壓力)</div>
                        <input type="number" placeholder="Call 1" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 2" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 3" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 4" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 5" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        <input type="number" placeholder="Call 6" class="call-input w-full px-2 py-1 text-sm border border-red-200 rounded focus:outline-none focus:ring-1 focus:ring-red-400">
                        
                        <div class="text-sm font-medium text-green-600 mt-3">Put (支撐)</div>
                        <input type="number" placeholder="Put 1" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 2" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 3" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 4" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 5" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                        <input type="number" placeholder="Put 6" class="put-input w-full px-2 py-1 text-sm border border-green-200 rounded focus:outline-none focus:ring-1 focus:ring-green-400">
                    </div>
                </div>
            </div>


        </div>

        <!-- 圖表區域 -->
        <div class="chart-area rounded-xl p-6 shadow-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">履約價分析圖表</h3>
                <div class="flex space-x-4 text-sm">
                    <div class="flex items-center">
                        <div class="w-4 h-1 bg-red-500 mr-2"></div>
                        <span>Call (壓力)</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-1 bg-green-500 mr-2"></div>
                        <span>Put (支撐)</span>
                    </div>
                </div>
            </div>
            
            <div class="relative">
                <svg id="chart" width="100%" height="500" viewBox="0 0 1000 500" class="border border-gray-200 rounded-lg bg-white"><text x="500" y="250" text-anchor="middle" fill="#666" font-size="18">請輸入數據後圖表會自動更新</text></svg>
            </div>
            
            <div id="tooltip" class="absolute bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 pointer-events-none transition-opacity duration-200 z-10">
            </div>
        </div>
        
        <!-- 左下角星號文字 -->
        <div class="fixed bottom-4 left-4">
            <span id="starBtn" class="text-gray-400 text-lg cursor-pointer select-none opacity-10 hover:opacity-30 transition-opacity duration-200" onclick="showCode()"></span>
        </div>

    </div>

    <script>
        let chartData = [];
        
        function parseDate(dateStr) {
            // 解析日期字符串，支持 M/D, MM/DD, M-D, MM-DD 格式
            const cleanStr = dateStr.replace(/[-\/]/g, '/');
            const parts = cleanStr.split('/');
            if (parts.length === 2) {
                const month = parseInt(parts[0]);
                const day = parseInt(parts[1]);
                if (month >= 1 && month <= 12 && day >= 1 && day <= 31) {
                    // 假設是當年的日期
                    const currentYear = new Date().getFullYear();
                    return new Date(currentYear, month - 1, day);
                }
            }
            return null;
        }
        
        function collectData() {
            chartData = [];
            const expiryGroups = document.querySelectorAll('.expiry-group');
            
            expiryGroups.forEach((group, index) => {
                const expiryInput = group.querySelector('.expiry-input');
                const expiryDate = expiryInput.value.trim();
                
                if (expiryDate) {
                    const callInputs = group.querySelectorAll('.call-input');
                    const putInputs = group.querySelectorAll('.put-input');
                    
                    const calls = Array.from(callInputs)
                        .map(input => parseFloat(input.value))
                        .filter(val => !isNaN(val));
                    
                    const puts = Array.from(putInputs)
                        .map(input => parseFloat(input.value))
                        .filter(val => !isNaN(val));
                    
                    if (calls.length > 0 || puts.length > 0) {
                        const parsedDate = parseDate(expiryDate);
                        chartData.push({
                            expiry: expiryDate,
                            calls: calls,
                            puts: puts,
                            index: index,
                            sortDate: parsedDate || new Date(2099, 11, 31) // 無效日期排到最後
                        });
                    }
                }
            });
            
            // 按日期排序
            chartData.sort((a, b) => a.sortDate - b.sortDate);
        }
        
        function calculateLineWidth(value, allValues) {
            if (allValues.length === 0) return 2;
            
            const min = Math.min(...allValues);
            const max = Math.max(...allValues);
            const range = max - min;
            
            if (range === 0) return 3;
            
            // 極值使用更粗的線條
            const normalizedDistance = Math.abs(value - (min + max) / 2) / (range / 2);
            return Math.max(1, Math.min(8, 2 + normalizedDistance * 6));
        }
        
        function drawChart() {
            const svg = document.getElementById('chart');
            svg.innerHTML = '';
            
            if (chartData.length === 0) {
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', '500');
                text.setAttribute('y', '250');
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('fill', '#666');
                text.setAttribute('font-size', '18');
                text.textContent = '請輸入數據後圖表會自動更新';
                svg.appendChild(text);
                return;
            }
            
            // 收集所有數值來計算範圍
            const allValues = [];
            chartData.forEach(data => {
                allValues.push(...data.calls, ...data.puts);
            });
            
            if (allValues.length === 0) return;
            
            const minValue = Math.min(...allValues);
            const maxValue = Math.max(...allValues);
            
            // 以50點為間距調整範圍
            const chartMinValue = Math.floor(minValue / 50) * 50 - 50;
            const chartMaxValue = Math.ceil(maxValue / 50) * 50 + 50;
            const chartRange = chartMaxValue - chartMinValue;
            
            // 圖表尺寸
            const chartWidth = 900;
            const chartHeight = 400;
            const chartLeft = 80;
            const chartTop = 50;
            
            // 繪製Y軸刻度線（50點間距）
            for (let value = chartMinValue; value <= chartMaxValue; value += 50) {
                const y = chartTop + chartHeight - ((value - chartMinValue) / chartRange * chartHeight);
                
                // 網格線
                const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', chartLeft);
                gridLine.setAttribute('y1', y);
                gridLine.setAttribute('x2', chartLeft + chartWidth);
                gridLine.setAttribute('y2', y);
                gridLine.setAttribute('stroke', '#e5e7eb');
                gridLine.setAttribute('stroke-width', '1');
                svg.appendChild(gridLine);
                
                // Y軸標籤已移除
            }
            
            // 收集平均值點、最大值點、最小值點用於連線
            const avgPoints = [];
            const maxPoints = [];
            const minPoints = [];
            const otherPoints = [];
            
            // 繪製數據點
            chartData.forEach((data, dataIndex) => {
                const x = chartLeft + (dataIndex * chartWidth / Math.max(1, chartData.length - 1));
                
                // X軸標籤
                const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                xLabel.setAttribute('x', x);
                xLabel.setAttribute('y', chartTop + chartHeight + 20);
                xLabel.setAttribute('text-anchor', 'middle');
                xLabel.setAttribute('fill', '#333');
                xLabel.setAttribute('font-size', '14');
                xLabel.setAttribute('font-weight', 'bold');
                xLabel.textContent = data.expiry;
                svg.appendChild(xLabel);
                
                // 計算該到期日的平均值、最大值、最小值
                const allValuesForDate = [...data.calls, ...data.puts];
                if (allValuesForDate.length > 0) {
                    const avgVal = allValuesForDate.reduce((sum, val) => sum + val, 0) / allValuesForDate.length;
                    const maxVal = Math.max(...allValuesForDate);
                    const minVal = Math.min(...allValuesForDate);
                    
                    const avgY = chartTop + chartHeight - ((avgVal - chartMinValue) / chartRange * chartHeight);
                    const maxY = chartTop + chartHeight - ((maxVal - chartMinValue) / chartRange * chartHeight);
                    const minY = chartTop + chartHeight - ((minVal - chartMinValue) / chartRange * chartHeight);
                    
                    avgPoints.push({ x, y: avgY, value: avgVal });
                    maxPoints.push({ x, y: maxY, value: maxVal });
                    minPoints.push({ x, y: minY, value: minVal });
                    
                    // 繪製Call點（只顯示大於平均值的）
                    data.calls.forEach(callValue => {
                        if (callValue >= avgVal) {
                            const y = chartTop + chartHeight - ((callValue - chartMinValue) / chartRange * chartHeight);
                            
                            const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                            circle.setAttribute('cx', x);
                            circle.setAttribute('cy', y);
                            circle.setAttribute('r', '4');
                            circle.setAttribute('fill', '#ef4444');
                            circle.setAttribute('stroke', '#dc2626');
                            circle.setAttribute('stroke-width', '2');
                            svg.appendChild(circle);
                            
                            // 收集其他點（非最大最小值）
                            if (callValue !== maxVal && callValue !== minVal) {
                                otherPoints.push({ x, y, value: callValue, type: 'Call' });
                            }
                        }
                    });
                    
                    // 繪製Put點（只顯示小於平均值的）
                    data.puts.forEach(putValue => {
                        if (putValue <= avgVal) {
                            const y = chartTop + chartHeight - ((putValue - chartMinValue) / chartRange * chartHeight);
                            
                            const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                            circle.setAttribute('cx', x);
                            circle.setAttribute('cy', y);
                            circle.setAttribute('r', '4');
                            circle.setAttribute('fill', '#22c55e');
                            circle.setAttribute('stroke', '#16a34a');
                            circle.setAttribute('stroke-width', '2');
                            svg.appendChild(circle);
                            
                            // 收集其他點（非最大最小值）
                            if (putValue !== maxVal && putValue !== minVal) {
                                otherPoints.push({ x, y, value: putValue, type: 'Put' });
                            }
                        }
                    });
                }
            });
            
            // 繪製最大值連線
            if (maxPoints.length > 1) {
                let pathData = `M ${maxPoints[0].x} ${maxPoints[0].y}`;
                for (let i = 1; i < maxPoints.length; i++) {
                    pathData += ` L ${maxPoints[i].x} ${maxPoints[i].y}`;
                }
                
                const maxLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                maxLine.setAttribute('d', pathData);
                maxLine.setAttribute('stroke', '#dc2626');
                maxLine.setAttribute('stroke-width', '3');
                maxLine.setAttribute('fill', 'none');
                maxLine.setAttribute('stroke-dasharray', '5,5');
                svg.appendChild(maxLine);
                
                // 標示最大值數字
                maxPoints.forEach(point => {
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', point.x);
                    text.setAttribute('y', point.y - 10);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', '#dc2626');
                    text.setAttribute('font-size', '12');
                    text.setAttribute('font-weight', 'bold');
                    text.textContent = point.value.toString();
                    svg.appendChild(text);
                });
            }
            
            // 繪製最小值連線
            if (minPoints.length > 1) {
                let pathData = `M ${minPoints[0].x} ${minPoints[0].y}`;
                for (let i = 1; i < minPoints.length; i++) {
                    pathData += ` L ${minPoints[i].x} ${minPoints[i].y}`;
                }
                
                const minLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                minLine.setAttribute('d', pathData);
                minLine.setAttribute('stroke', '#16a34a');
                minLine.setAttribute('stroke-width', '3');
                minLine.setAttribute('fill', 'none');
                minLine.setAttribute('stroke-dasharray', '5,5');
                svg.appendChild(minLine);
                
                // 標示最小值數字
                minPoints.forEach(point => {
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', point.x);
                    text.setAttribute('y', point.y + 20);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', '#16a34a');
                    text.setAttribute('font-size', '12');
                    text.setAttribute('font-weight', 'bold');
                    text.textContent = point.value.toString();
                    svg.appendChild(text);
                });
            }
            
            // 繪製平均值連線
            if (avgPoints.length > 1) {
                let pathData = `M ${avgPoints[0].x} ${avgPoints[0].y}`;
                for (let i = 1; i < avgPoints.length; i++) {
                    pathData += ` L ${avgPoints[i].x} ${avgPoints[i].y}`;
                }
                
                const avgLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                avgLine.setAttribute('d', pathData);
                avgLine.setAttribute('stroke', '#6366f1');
                avgLine.setAttribute('stroke-width', '3');
                avgLine.setAttribute('fill', 'none');
                avgLine.setAttribute('stroke-dasharray', '8,4');
                svg.appendChild(avgLine);
                
                // 標示平均值數字
                avgPoints.forEach(point => {
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', point.x);
                    text.setAttribute('y', point.y - 10);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', '#6366f1');
                    text.setAttribute('font-size', '12');
                    text.setAttribute('font-weight', 'bold');
                    text.textContent = Math.round(point.value).toString();
                    svg.appendChild(text);
                });
            }
            
            // 在右邊顯示其他點的數字
            otherPoints.forEach((point, index) => {
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', chartLeft + chartWidth + 20);
                text.setAttribute('y', point.y);
                text.setAttribute('text-anchor', 'start');
                text.setAttribute('fill', point.type === 'Call' ? '#dc2626' : '#16a34a');
                text.setAttribute('font-size', '11');
                text.textContent = point.value.toString();
                svg.appendChild(text);
            });
        }
        
        function showTooltip(event, value, expiry) {
            const tooltip = document.getElementById('tooltip');
            tooltip.innerHTML = `${expiry}<br>${value}`;
            tooltip.style.opacity = '1';
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
        }
        
        function hideTooltip() {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.opacity = '0';
        }
        
        // 保存數據到本地存儲
        function saveData() {
            const data = {};
            const expiryGroups = document.querySelectorAll('.expiry-group');
            
            expiryGroups.forEach((group, index) => {
                const expiryInput = group.querySelector('.expiry-input');
                const callInputs = group.querySelectorAll('.call-input');
                const putInputs = group.querySelectorAll('.put-input');
                
                data[`expiry_${index}`] = expiryInput.value;
                callInputs.forEach((input, i) => {
                    data[`call_${index}_${i}`] = input.value;
                });
                putInputs.forEach((input, i) => {
                    data[`put_${index}_${i}`] = input.value;
                });
            });
            
            localStorage.setItem('strikeAnalysisData', JSON.stringify(data));
        }
        
        // 從本地存儲載入數據
        function loadData() {
            const savedData = localStorage.getItem('strikeAnalysisData');
            if (savedData) {
                const data = JSON.parse(savedData);
                const expiryGroups = document.querySelectorAll('.expiry-group');
                
                expiryGroups.forEach((group, index) => {
                    const expiryInput = group.querySelector('.expiry-input');
                    const callInputs = group.querySelectorAll('.call-input');
                    const putInputs = group.querySelectorAll('.put-input');
                    
                    if (data[`expiry_${index}`]) {
                        expiryInput.value = data[`expiry_${index}`];
                    }
                    callInputs.forEach((input, i) => {
                        if (data[`call_${index}_${i}`]) {
                            input.value = data[`call_${index}_${i}`];
                        }
                    });
                    putInputs.forEach((input, i) => {
                        if (data[`put_${index}_${i}`]) {
                            input.value = data[`put_${index}_${i}`];
                        }
                    });
                });
            }
        }
        

        
        // 輸入時即時更新並保存
        document.addEventListener('input', (e) => {
            if (e.target.matches('.expiry-input, .call-input, .put-input')) {
                collectData();
                drawChart();
                saveData();
            }
        });
        
        // 頁面載入時讀取數據
        window.addEventListener('load', () => {
            loadData();
            collectData();
            drawChart();
        });
        
        // 顯示網頁程式碼
        function showCode() {
            const htmlContent = document.documentElement.outerHTML;
            const newWindow = window.open('', '_blank');
            newWindow.document.open();
            newWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>網頁程式碼</title>
                    <style>
                        body { 
                            font-family: 'Courier New', monospace; 
                            font-size: 12px; 
                            line-height: 1.4; 
                            padding: 20px; 
                            background: #f5f5f5;
                            margin: 0;
                        }
                        pre { 
                            background: white; 
                            padding: 20px; 
                            border-radius: 8px; 
                            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                            white-space: pre-wrap; 
                            word-wrap: break-word; 
                            overflow-x: auto;
                        }
                        .header {
                            background: #333;
                            color: white;
                            padding: 15px 20px;
                            margin: -20px -20px 20px -20px;
                            border-radius: 8px 8px 0 0;
                            font-weight: bold;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">重點履約價互動式圖表 - 完整程式碼</div>
                    <pre>${htmlContent.replace(/</g, '<').replace(/>/g, '>')}</pre>
                </body>
                </html>
            `);
            newWindow.document.close();
        }
        
        // 初始化圖表
        drawChart();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'95c71983b642f230',t:'MTc1MjA1NjU0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>

</body></html>